<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Care Connect - Your Trusted Digital Healthcare Partner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ============================================
           GLOBAL STYLES & RESET
           ============================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #0066CC;
            --primary-green: #00A86B;
            --soft-blue: #E8F4F8;
            --soft-green: #E8F5E9;
            --dark-blue: #003D7A;
            --text-dark: #1A1A1A;
            --text-gray: #666666;
            --white: #FFFFFF;
            --light-gray: #F5F7FA;
            --border-color: #E0E0E0;
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 32px rgba(0,0,0,0.16);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            color: var(--text-dark);
            line-height: 1.6;
            background: var(--white);
            overflow-x: hidden;
        }

        /* ============================================
           UTILITY CLASSES
           ============================================ */
        .hidden {
            display: none !important;
        }

        .page {
            display: none;
            animation: fadeIn 0.6s ease-in;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .btn {
            padding: 14px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            color: var(--white);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
        }

        .btn-secondary:hover {
            background: var(--primary-blue);
            color: var(--white);
        }

        /* ============================================
           FIXED NAVBAR
           ============================================ */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--white);
            box-shadow: var(--shadow-sm);
            z-index: 1000;
            padding: 1rem 0;
        }

        .navbar-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--text-dark);
        }

        .navbar-logo {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 24px;
            font-weight: bold;
        }

        .navbar-name {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-blue);
            letter-spacing: -0.5px;
        }

        .navbar-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .navbar-btn {
            padding: 10px 24px;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            text-decoration: none;
        }

        .navbar-btn-login {
            background: var(--primary-blue);
            color: var(--white);
        }

        .navbar-btn-login:hover {
            background: var(--dark-blue);
            transform: translateY(-1px);
        }

        .navbar-btn-register {
            background: var(--white);
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
        }

        .navbar-btn-register:hover {
            background: var(--soft-blue);
        }

        /* ============================================
           HOMEPAGE - HERO SECTION
           ============================================ */
        .hero {
            background: linear-gradient(135deg, #E8F4F8 0%, #E8F5E9 100%);
            padding: 140px 0 100px;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(0, 102, 204, 0.1) 0%, transparent 70%);
            border-radius: 50%;
        }

        .hero::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -5%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(0, 168, 107, 0.1) 0%, transparent 70%);
            border-radius: 50%;
        }

        .hero-content {
            position: relative;
            z-index: 1;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero-title {
            font-size: 56px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 24px;
            line-height: 1.2;
            letter-spacing: -1px;
        }

        .hero-subtitle {
            font-size: 20px;
            color: var(--text-gray);
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .hero-cta {
            display: flex;
            gap: 16px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* ============================================
           HOMEPAGE - SERVICES SECTION
           ============================================ */
        .services {
            padding: 80px 0;
            background: var(--white);
        }

        .section-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .section-title {
            font-size: 42px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 16px;
            letter-spacing: -0.5px;
        }

        .section-subtitle {
            font-size: 18px;
            color: var(--text-gray);
            max-width: 600px;
            margin: 0 auto;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 32px;
            margin-top: 48px;
        }

        .service-card {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 40px 32px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        .service-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-blue);
        }

        .service-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--soft-blue), var(--soft-green));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 36px;
            color: var(--primary-blue);
        }

        .service-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 12px;
        }

        .service-description {
            font-size: 15px;
            color: var(--text-gray);
            line-height: 1.6;
        }

        /* ============================================
           HOMEPAGE - ABOUT SECTION
           ============================================ */
        .about {
            padding: 80px 0;
            background: var(--light-gray);
        }

        .about-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
        }

        .about-image {
            background: linear-gradient(135deg, var(--soft-blue), var(--soft-green));
            border-radius: 20px;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 120px;
            color: var(--primary-blue);
            opacity: 0.3;
        }

        .about-text h2 {
            font-size: 36px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 24px;
            letter-spacing: -0.5px;
        }

        .about-text p {
            font-size: 17px;
            color: var(--text-gray);
            line-height: 1.8;
            margin-bottom: 16px;
        }

        /* ============================================
           HOMEPAGE - WHY CHOOSE US
           ============================================ */
        .why-choose {
            padding: 80px 0;
            background: var(--white);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 32px;
            margin-top: 48px;
        }

        .feature-card {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 32px;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }

        .feature-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-green);
        }

        .feature-icon {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 24px;
            margin-bottom: 20px;
        }

        .feature-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 12px;
        }

        .feature-description {
            font-size: 15px;
            color: var(--text-gray);
            line-height: 1.6;
        }

        /* ============================================
           HOMEPAGE - FOOTER
           ============================================ */
        .footer {
            background: var(--text-dark);
            color: var(--white);
            padding: 60px 0 30px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-section h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .footer-section p,
        .footer-section a {
            font-size: 15px;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            display: block;
            margin-bottom: 12px;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: var(--white);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 30px;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
        }

        /* ============================================
           UNIFIED LOGIN PAGE
           ============================================ */
        .login-page {
            min-height: 100vh;
            background: linear-gradient(135deg, #E8F4F8 0%, #E8F5E9 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 100px 20px 40px;
            position: relative;
            overflow: hidden;
        }

        .login-page::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(0, 102, 204, 0.08) 0%, transparent 70%);
            border-radius: 50%;
        }

        .login-page::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -5%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(0, 168, 107, 0.08) 0%, transparent 70%);
            border-radius: 50%;
        }

        .login-container {
            background: var(--white);
            border-radius: 24px;
            padding: 48px;
            max-width: 520px;
            width: 100%;
            box-shadow: var(--shadow-lg);
            position: relative;
            z-index: 1;
        }

        .login-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .login-logo {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            color: var(--white);
            font-size: 32px;
            font-weight: bold;
        }

        .login-title {
            font-size: 32px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .login-subtitle {
            font-size: 16px;
            color: var(--text-gray);
        }

        /* Role Tabs */
        .role-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            background: var(--light-gray);
            padding: 6px;
            border-radius: 12px;
        }

        .role-tab {
            flex: 1;
            padding: 14px 16px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-gray);
        }

        .role-tab i {
            font-size: 20px;
        }

        .role-tab:hover {
            background: rgba(0, 102, 204, 0.1);
            color: var(--primary-blue);
        }

        .role-tab.active {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            color: var(--white);
            box-shadow: var(--shadow-sm);
        }

        .role-tab.active i {
            color: var(--white);
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 4px rgba(0, 102, 204, 0.1);
        }

        .form-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            color: var(--white);
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 8px;
            box-shadow: var(--shadow-md);
        }

        .form-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .error-message {
            background: #FEE;
            color: #C33;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 24px;
            display: none;
            font-size: 14px;
        }

        .error-message.show {
            display: block;
        }

        .login-warning {
            background: #FFF3CD;
            border: 1px solid #FFC107;
            border-radius: 10px;
            padding: 16px;
            margin-top: 24px;
            text-align: center;
        }

        .login-warning-text {
            color: #856404;
            font-size: 13px;
            font-weight: 600;
        }

        /* ============================================
           DASHBOARD STYLES - REDESIGNED
           ============================================ */
        .dashboard-container {
            min-height: 100vh;
            display: flex;
            background: var(--light-gray);
        }

        .dashboard-sidebar {
            width: 260px;
            background: var(--white);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            color: var(--white);
        }

        .sidebar-header h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .sidebar-header p {
            font-size: 13px;
            opacity: 0.9;
        }

        .sidebar-content {
            flex: 1;
            padding: 0.5rem 0;
            overflow-y: auto;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            color: var(--text-dark);
            font-size: 15px;
        }

        .menu-item i {
            width: 20px;
            text-align: center;
            font-size: 18px;
        }

        .menu-item:hover {
            background: var(--soft-blue);
            border-left-color: var(--primary-blue);
            transform: translateX(2px);
        }

        .menu-item.active {
            background: var(--soft-blue);
            border-left-color: var(--primary-blue);
            color: var(--primary-blue);
            font-weight: 600;
        }

        .dashboard-main {
            flex: 1;
            margin-left: 260px;
            padding: 0;
            background: var(--light-gray);
        }

        .dashboard-topbar {
            background: var(--white);
            padding: 1.25rem 2rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 50;
            box-shadow: var(--shadow-sm);
        }

        .topbar-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .topbar-greeting h2 {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-dark);
            margin: 0;
        }

        .topbar-greeting p {
            font-size: 14px;
            color: var(--text-gray);
            margin: 0;
        }

        .topbar-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .notification-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--light-gray);
            color: var(--text-dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .notification-btn:hover {
            background: var(--soft-blue);
        }

        .notification-badge {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 8px;
            height: 8px;
            background: #FF4444;
            border-radius: 50%;
            border: 2px solid var(--white);
        }

        .dashboard-content {
            padding: 2rem;
            max-width: 1400px;
        }

        .page-header {
            margin-bottom: 2rem;
        }

        .page-header h1 {
            font-size: 32px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .page-header p {
            font-size: 16px;
            color: var(--text-gray);
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .dashboard-card {
            background: var(--white);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .dashboard-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--primary-blue);
        }

        .card-body {
            color: var(--text-gray);
            font-size: 15px;
            line-height: 1.6;
        }

        /* Next Appointment Card */
        .appointment-card {
            background: linear-gradient(135deg, var(--soft-blue), var(--soft-green));
            border: 2px solid var(--primary-blue);
        }

        .appointment-info {
            margin-bottom: 16px;
        }

        .appointment-info-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            font-size: 15px;
        }

        .appointment-info-item i {
            color: var(--primary-blue);
            width: 20px;
        }

        .appointment-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .btn-sm {
            padding: 10px 20px;
            font-size: 14px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-outline {
            background: var(--white);
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
        }

        .btn-outline:hover {
            background: var(--primary-blue);
            color: var(--white);
        }

        /* Medications List */
        .medication-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: var(--light-gray);
            border-radius: 12px;
            margin-bottom: 12px;
        }

        .medication-info h4 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .medication-info p {
            font-size: 14px;
            color: var(--text-gray);
            margin: 0;
        }

        /* Health Queries */
        .query-item {
            padding: 16px;
            background: var(--light-gray);
            border-left: 4px solid var(--primary-blue);
            border-radius: 8px;
            margin-bottom: 12px;
        }

        .query-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }

        .query-title {
            font-weight: 600;
            color: var(--text-dark);
        }

        .query-priority {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .priority-high {
            background: #FFE5E5;
            color: #C33;
        }

        .priority-medium {
            background: #FFF3CD;
            color: #856404;
        }

        .priority-low {
            background: #E8F5E9;
            color: #2E7D32;
        }

        /* Care Team */
        .care-team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .doctor-card {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .doctor-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-4px);
        }

        .doctor-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            color: var(--white);
            font-size: 32px;
            font-weight: bold;
        }

        .doctor-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .doctor-specialty {
            font-size: 14px;
            color: var(--text-gray);
            margin-bottom: 16px;
        }

        .doctor-actions {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 32px;
        }

        .action-btn {
            flex: 1;
            min-width: 160px;
            padding: 20px;
            background: var(--white);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            text-decoration: none;
            color: var(--text-dark);
        }

        .action-btn:hover {
            border-color: var(--primary-blue);
            background: var(--soft-blue);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .action-btn i {
            font-size: 32px;
            color: var(--primary-blue);
            margin-bottom: 12px;
            display: block;
        }

        .action-btn span {
            display: block;
            font-weight: 600;
            font-size: 15px;
        }

        .logout-btn {
            background: #DC3545;
            color: var(--white);
            border: none;
            padding: 10px 24px;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #C82333;
            transform: translateY(-1px);
        }

        /* ============================================
           CHATBOT STYLES (Only in Dashboard)
           ============================================ */
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: var(--white);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .chatbot-container.minimized {
            width: 0;
            height: 0;
            opacity: 0;
            pointer-events: none;
        }

        .chatbot-floating-icon {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 9999;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }

        .chatbot-floating-icon.show {
            display: flex;
        }

        .chatbot-floating-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 24px rgba(0, 102, 204, 0.4);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .chatbot-header {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            color: var(--white);
            padding: 16px 20px;
            border-radius: 20px 20px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chatbot-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chatbot-minimize-btn {
            background: none;
            border: none;
            color: var(--white);
            cursor: pointer;
            font-size: 20px;
            padding: 4px;
            opacity: 0.9;
            transition: opacity 0.3s ease;
        }

        .chatbot-minimize-btn:hover {
            opacity: 1;
        }

        .chatbot-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 14px;
            flex-shrink: 0;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
        }

        .message.bot .message-avatar {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
        }

        .message-content {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            background: var(--light-gray);
            color: var(--text-dark);
            font-size: 14px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            color: var(--white);
        }

        .chatbot-input-container {
            padding: 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chatbot-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .chatbot-input:focus {
            border-color: var(--primary-blue);
        }

        .chatbot-send {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-green));
            color: var(--white);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .chatbot-send:hover {
            transform: scale(1.05);
        }

        .chatbot-send:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* ============================================
           APPOINTMENTS PAGE STYLES
           ============================================ */
        .appointment-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .appointment-card-item {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .appointment-card-item:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--primary-blue);
        }

        .appointment-date {
            font-size: 14px;
            color: var(--text-gray);
            margin-bottom: 12px;
        }

        .appointment-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .appointment-history-item {
            background: var(--light-gray);
            border-left: 4px solid var(--primary-green);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .appointment-summary {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }

        .appointment-summary h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .appointment-summary p {
            font-size: 14px;
            color: var(--text-gray);
            margin-bottom: 4px;
        }

        /* Schedule Appointment Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background: var(--white);
            border-radius: 16px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-header h2 {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-dark);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-gray);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .time-slot {
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .time-slot:hover {
            border-color: var(--primary-blue);
            background: var(--soft-blue);
        }

        .time-slot.selected {
            border-color: var(--primary-blue);
            background: var(--primary-blue);
            color: var(--white);
        }

        /* ============================================
           MEDICAL RECORDS PAGE STYLES
           ============================================ */
        .records-timeline {
            position: relative;
            padding-left: 32px;
        }

        .records-timeline::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 32px;
        }

        .timeline-dot {
            position: absolute;
            left: -24px;
            top: 4px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--primary-blue);
            border: 3px solid var(--white);
            box-shadow: 0 0 0 2px var(--primary-blue);
        }

        .timeline-content {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
        }

        .timeline-date {
            font-size: 14px;
            color: var(--text-gray);
            margin-bottom: 8px;
        }

        .timeline-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 12px;
        }

        .lab-result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: var(--light-gray);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .lab-result-name {
            font-weight: 600;
            color: var(--text-dark);
        }

        .lab-result-value {
            font-weight: 600;
        }

        .badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-normal {
            background: #E8F5E9;
            color: #2E7D32;
        }

        .badge-abnormal {
            background: #FFE5E5;
            color: #C33;
        }

        .download-btn {
            padding: 8px 16px;
            background: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            background: var(--dark-blue);
        }

        /* ============================================
           MEDICATIONS PAGE STYLES
           ============================================ */
        .medication-section {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border-color);
        }

        .medication-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .medication-detail-item {
            font-size: 14px;
            color: var(--text-gray);
        }

        .medication-detail-item strong {
            color: var(--text-dark);
        }

        .refill-status {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
        }

        .refill-active {
            background: #E8F5E9;
            color: #2E7D32;
        }

        .refill-due {
            background: #FFF3CD;
            color: #856404;
        }

        .refill-expired {
            background: #FFE5E5;
            color: #C33;
        }

        /* ============================================
           ENHANCED DASHBOARD STYLES
           ============================================ */
        .search-filter-bar {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        .filter-select {
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .patient-card-enhanced {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .patient-card-enhanced:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .patient-card-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
        }

        .patient-card-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .patient-card-info {
            font-size: 14px;
            color: var(--text-gray);
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-stable {
            background: #E8F5E9;
            color: #2E7D32;
        }

        .status-attention {
            background: #FFF3E0;
            color: #F57C00;
        }

        .status-critical {
            background: #FFEBEE;
            color: #C62828;
        }

        .priority-high {
            background: #FFEBEE;
            color: #C62828;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .priority-medium {
            background: #FFF3E0;
            color: #F57C00;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .priority-low {
            background: #E3F2FD;
            color: #1976D2;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .ai-panel {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.1), rgba(39, 174, 96, 0.1));
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-top: 24px;
        }

        .ai-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .ai-panel-title {
            font-size: 18px;
            font-weight: 600;
            color: #27ae60;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .ai-panel-content {
            color: var(--text-dark);
            line-height: 1.6;
        }

        .mini-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .calendar-header {
            text-align: center;
            font-weight: 600;
            font-size: 12px;
            color: var(--text-gray);
            padding: 8px 4px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .calendar-day:hover {
            background: var(--soft-blue);
        }

        .calendar-day.today {
            background: var(--primary-blue);
            color: white;
            font-weight: 600;
        }

        .calendar-day.other-month {
            color: #ccc;
        }

        .calendar-day.has-appointment {
            background: var(--primary-green);
            color: white;
        }

        /* ============================================
           RESPONSIVE STYLES
           ============================================ */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 36px;
            }

            .hero-subtitle {
                font-size: 18px;
            }

            .section-title {
                font-size: 32px;
            }

            .about-content {
                grid-template-columns: 1fr;
            }

            .navbar-actions {
                gap: 8px;
            }

            .navbar-btn {
                padding: 8px 16px;
                font-size: 14px;
            }

            .dashboard-sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .dashboard-sidebar.open {
                transform: translateX(0);
            }

            .dashboard-main {
                margin-left: 0;
            }

            .dashboard-content {
                padding: 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                flex-direction: column;
            }

            .action-btn {
                min-width: 100%;
            }

            .care-team-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .time-slots {
                grid-template-columns: repeat(2, 1fr);
            }

            .chatbot-container {
                width: calc(100% - 40px);
                height: 400px;
                bottom: 10px;
                right: 20px;
            }

            .chatbot-floating-icon {
                bottom: 20px;
                right: 20px;
                width: 56px;
                height: 56px;
            }
        }
    </style>
</head>
<body>
    <!-- ============================================
         HOMEPAGE
         ============================================ -->
    <div id="home-page" class="page active">
        <!-- Fixed Navbar -->
        <nav class="navbar">
            <div class="navbar-content">
                <a href="#" class="navbar-brand" onclick="showPage('home-page'); return false;">
                    <div class="navbar-logo">CC</div>
                    <div class="navbar-name">Care Connect</div>
                </a>
                <div class="navbar-actions">
                    <button class="navbar-btn navbar-btn-login" onclick="showPage('unified-login'); return false;">Login</button>
                    <button class="navbar-btn navbar-btn-register" onclick="showPage('unified-login'); return false;">Register</button>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero">
            <div class="container">
                <div class="hero-content">
                    <h1 class="hero-title">Your Trusted Digital Healthcare Partner</h1>
                    <p class="hero-subtitle">Access medical services, doctors, appointments, and lab results in one place. Secure, fast, and designed with your health in mind.</p>
                    <div class="hero-cta">
                        <a href="#" class="btn btn-primary" onclick="showPage('unified-login'); return false;">
                            <i class="fas fa-sign-in-alt"></i> Login to Patient Portal
                        </a>
                        <a href="#" class="btn btn-secondary" onclick="showPage('unified-login'); return false;">
                            Learn More
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section class="services">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Our Services</h2>
                    <p class="section-subtitle">Comprehensive healthcare services at your fingertips</p>
                </div>
                <div class="services-grid">
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <h3 class="service-title">Appointments</h3>
                        <p class="service-description">Schedule and manage your medical appointments with ease. View your upcoming visits and appointment history.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-vial"></i>
                        </div>
                        <h3 class="service-title">Lab Results</h3>
                        <p class="service-description">Access your laboratory test results securely. View detailed reports and track your health metrics over time.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-pills"></i>
                        </div>
                        <h3 class="service-title">Pharmacy</h3>
                        <p class="service-description">Manage your prescriptions and medications. Get refill reminders and medication information.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-ambulance"></i>
                        </div>
                        <h3 class="service-title">Emergency Care</h3>
                        <p class="service-description">24/7 emergency services with immediate access to critical care information and emergency contacts.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-book-medical"></i>
                        </div>
                        <h3 class="service-title">Patient Education</h3>
                        <p class="service-description">Access educational resources, health articles, and wellness tips to manage your health better.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-user-md"></i>
                        </div>
                        <h3 class="service-title">Doctor Directory</h3>
                        <p class="service-description">Find and connect with healthcare providers. View doctor profiles, specialties, and availability.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section class="about">
            <div class="container">
                <div class="about-content">
                    <div class="about-image">
                        <i class="fas fa-hospital"></i>
                    </div>
                    <div class="about-text">
                        <h2>About Care Connect</h2>
                        <p>Care Connect is a modern digital healthcare platform designed to put you in control of your health. We provide a secure, user-friendly portal where patients can access their medical information, communicate with healthcare providers, and manage their health journey.</p>
                        <p>Our platform combines cutting-edge technology with compassionate care, ensuring that your health data is always accessible, secure, and easy to understand. Whether you need to schedule an appointment, review test results, or refill a prescription, Care Connect makes it simple.</p>
                        <p>Built with patient privacy and security as our top priorities, we follow industry-leading security standards to protect your sensitive health information.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Why Choose Us Section -->
        <section class="why-choose">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Why Choose Care Connect</h2>
                    <p class="section-subtitle">Experience healthcare that's designed around you</p>
                </div>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <h3 class="feature-title">Fast Results</h3>
                        <p class="feature-description">Get instant access to your lab results and medical records. No more waiting for phone calls or mail.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h3 class="feature-title">24/7 Access</h3>
                        <p class="feature-description">Access your health information anytime, anywhere. Your medical records are always at your fingertips.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3 class="feature-title">Secure & HIPAA-Compliant</h3>
                        <p class="feature-description">Your privacy is our priority. We use enterprise-grade security to protect your sensitive health data.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h3 class="feature-title">AI-Powered Assistance</h3>
                        <p class="feature-description">Get instant answers to health-related questions with our intelligent health assistant (available after login).</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-section">
                        <h3>Contact Us</h3>
                        <p><i class="fas fa-phone"></i> (555) 123-4567</p>
                        <p><i class="fas fa-envelope"></i> support@careconnect.com</p>
                        <p><i class="fas fa-map-marker-alt"></i> 123 Medical Center Dr, City, State 12345</p>
                    </div>
                    <div class="footer-section">
                        <h3>Support</h3>
                        <a href="#">Help Center</a>
                        <a href="#">FAQs</a>
                        <a href="#">Contact Support</a>
                        <a href="#">Technical Support</a>
                    </div>
                    <div class="footer-section">
                        <h3>Resources</h3>
                        <a href="#">Patient Education</a>
                        <a href="#">Health Articles</a>
                        <a href="#">Wellness Tips</a>
                        <a href="#">Privacy Policy</a>
                    </div>
                    <div class="footer-section">
                        <h3>About</h3>
                        <a href="#">Our Mission</a>
                        <a href="#">Care Team</a>
                        <a href="#">Careers</a>
                        <a href="#">News & Updates</a>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>&copy; 2024 Care Connect. All rights reserved. | This is a college project and not a real medical system.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- ============================================
         UNIFIED LOGIN PAGE (All Roles)
         ============================================ -->
    <div id="unified-login" class="page">
        <nav class="navbar">
            <div class="navbar-content">
                <a href="#" class="navbar-brand" onclick="showPage('home-page'); return false;">
                    <div class="navbar-logo">CC</div>
                    <div class="navbar-name">Care Connect</div>
                </a>
                <div class="navbar-actions">
                    <button class="navbar-btn navbar-btn-register" onclick="showPage('home-page')">Back to Home</button>
                </div>
            </div>
        </nav>

        <div class="login-page">
            <div class="login-container">
                <div class="login-header">
                    <div class="login-logo">CC</div>
                    <h1 class="login-title">Login to Care Connect</h1>
                    <p class="login-subtitle">Select your role to continue</p>
                </div>

                <!-- Role Tabs -->
                <div class="role-tabs">
                    <button class="role-tab active" onclick="switchRole('patient')" id="tab-patient">
                        <i class="fas fa-user"></i>
                        <span>Patient</span>
                    </button>
                    <button class="role-tab" onclick="switchRole('doctor')" id="tab-doctor">
                        <i class="fas fa-user-md"></i>
                        <span>Doctor</span>
                    </button>
                    <button class="role-tab" onclick="switchRole('admin')" id="tab-admin">
                        <i class="fas fa-user-shield"></i>
                        <span>Admin</span>
                    </button>
                </div>

                <!-- Dynamic Form Based on Role -->
                <div class="error-message" id="login-error"></div>

                <!-- Patient Login Form -->
                <form id="login-form-patient" onsubmit="handleUnifiedLogin(event, 'patient')" style="display: block;">
                    <div class="form-group">
                        <label for="login-username" class="form-label">
                            <i class="fas fa-user"></i> Username
                        </label>
                        <input type="text" id="login-username" name="username" class="form-input" placeholder="Enter your username" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password" class="form-label">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <input type="password" id="login-password" name="password" class="form-input" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="form-btn">
                        <i class="fas fa-sign-in-alt"></i> Login as Patient
                    </button>
                </form>

                <!-- Doctor Login Form -->
                <form id="login-form-doctor" onsubmit="handleUnifiedLogin(event, 'doctor')" style="display: none;">
                    <div class="form-group">
                        <label for="login-doctor-id" class="form-label">
                            <i class="fas fa-id-card"></i> Doctor ID
                        </label>
                        <input type="text" id="login-doctor-id" name="doctorId" class="form-input" placeholder="Enter your Doctor ID" required>
                    </div>
                    <div class="form-group">
                        <label for="login-doctor-password" class="form-label">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <input type="password" id="login-doctor-password" name="password" class="form-input" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="form-btn">
                        <i class="fas fa-sign-in-alt"></i> Login as Doctor
                    </button>
                </form>

                <!-- Admin Login Form -->
                <form id="login-form-admin" onsubmit="handleUnifiedLogin(event, 'admin')" style="display: none;">
                    <div class="form-group">
                        <label for="login-admin-email" class="form-label">
                            <i class="fas fa-envelope"></i> Admin Email
                        </label>
                        <input type="email" id="login-admin-email" name="email" class="form-input" placeholder="Enter your admin email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-admin-password" class="form-label">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <input type="password" id="login-admin-password" name="password" class="form-input" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="form-btn">
                        <i class="fas fa-sign-in-alt"></i> Login as Admin
                    </button>
                </form>

                <div class="login-warning">
                    <p class="login-warning-text"> This is a college project, not a real medical system.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================
         PATIENT DASHBOARD (Chatbot appears here)
         ============================================ -->
    <div id="patient-dashboard" class="page">
        <div class="dashboard-container">
            <div class="dashboard-sidebar" id="patient-sidebar">
                <div class="sidebar-header">
                    <h3 id="patient-name">Patient</h3>
                    <p>Patient Portal</p>
                </div>
                <div class="sidebar-content">
                    <div class="menu-item active" onclick="showDashboardSection('patient-overview')">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="menu-item" onclick="showDashboardSection('patient-appointments')">
                        <i class="fas fa-calendar-check"></i>
                        <span>Appointments</span>
                    </div>
                    <div class="menu-item" onclick="showDashboardSection('patient-records')">
                        <i class="fas fa-file-medical"></i>
                        <span>Medical Records</span>
                    </div>
                    <div class="menu-item" onclick="showDashboardSection('patient-medications')">
                        <i class="fas fa-pills"></i>
                        <span>Medications</span>
                    </div>
                </div>
                <div style="padding: 1rem;">
                    <button class="logout-btn" onclick="handleLogout()" style="width: 100%;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
            <div class="dashboard-main">
                <div class="dashboard-topbar">
                    <div class="topbar-left">
                        <div class="topbar-greeting">
                            <h2>Welcome back, <span id="patient-welcome-name">Patient</span>!</h2>
                            <p id="current-date"></p>
                        </div>
                    </div>
                    <div class="topbar-right">
                        <button class="notification-btn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge"></span>
                        </button>
                        <button class="logout-btn" onclick="handleLogout()">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
                <div class="dashboard-content" id="patient-dashboard-content">
                    <!-- Content will be dynamically loaded here -->
                </div>
            </div>
        </div>
        
        <!-- Chatbot - Only appears in dashboard -->
        <div class="chatbot-container" id="chatbot-container">
            <div class="chatbot-header">
                <div class="chatbot-header-left">
                    <div>
                        <h3 style="margin: 0; font-size: 16px;">Health Assistant</h3>
                        <p style="margin: 0; font-size: 12px; opacity: 0.9;">Ask me anything about health</p>
                    </div>
                </div>
                <button class="chatbot-minimize-btn" onclick="minimizeChatbot()">
                    <i class="fas fa-minus"></i>
                </button>
            </div>
            <div class="chatbot-body" id="chatbot-body">
                <div class="chatbot-messages" id="chatbot-messages">
                    <div class="message bot">
                        <div class="message-avatar"></div>
                        <div class="message-content">
                            Hello! I'm your health assistant. I can help answer health-related questions. Please note that I'm not a medical professional and always recommend consulting with a qualified healthcare provider.
                        </div>
                    </div>
                </div>
                <div class="chatbot-input-container">
                    <input type="text" class="chatbot-input" id="chatbot-input" placeholder="Ask a health question..." onkeypress="handleChatbotKeyPress(event)">
                    <button class="chatbot-send" onclick="sendChatbotMessage()"></button>
                </div>
            </div>
        </div>

        <!-- Floating Chatbot Icon -->
        <div class="chatbot-floating-icon" id="chatbot-floating-icon" onclick="openChatbot()">
            <i class="fas fa-comments"></i>
        </div>
    </div>

    <!-- ============================================
         DOCTOR DASHBOARD (No chatbot)
         ============================================ -->
    <div id="doctor-dashboard" class="page">
        <div class="dashboard-container">
            <div class="dashboard-sidebar" id="doctor-sidebar">
                <div class="sidebar-header">
                    <h3 id="doctor-name">Doctor</h3>
                    <p>Doctor Portal</p>
                </div>
                <div class="sidebar-content">
                    <div class="menu-item active" onclick="showDoctorSection('overview')">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="menu-item" onclick="showDoctorSection('patients')">
                        <i class="fas fa-users"></i>
                        <span>My Patients</span>
                    </div>
                    <div class="menu-item" onclick="showDoctorSection('appointments')">
                        <i class="fas fa-calendar-check"></i>
                        <span>Appointments</span>
                    </div>
                    <div class="menu-item" onclick="showDoctorSection('reports')">
                        <i class="fas fa-file-medical-alt"></i>
                        <span>Pending Reports</span>
                        <span style="background: #FF4444; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: auto;">3</span>
                    </div>
                    <div class="menu-item" onclick="showDoctorSection('messages')">
                        <i class="fas fa-envelope"></i>
                        <span>Messages</span>
                        <span style="background: #FF4444; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: auto;">2</span>
                    </div>
                    <div class="menu-item" onclick="showDoctorSection('prescriptions')">
                        <i class="fas fa-prescription"></i>
                        <span>Prescriptions</span>
                    </div>
                    <div class="menu-item" onclick="showDoctorSection('case-notes')">
                        <i class="fas fa-sticky-note"></i>
                        <span>Case Notes</span>
                    </div>
                </div>
                <div style="padding: 1rem;">
                    <button class="logout-btn" onclick="handleLogout()" style="width: 100%;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
            <div class="dashboard-main">
                <div class="dashboard-topbar">
                    <div class="topbar-left">
                        <div class="topbar-greeting">
                            <h2>Welcome, Dr. <span id="doctor-welcome-name">Doctor</span>!</h2>
                            <p id="doctor-current-date"></p>
                        </div>
                    </div>
                    <div class="topbar-right">
                        <button class="notification-btn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge"></span>
                        </button>
                        <button class="logout-btn" onclick="handleLogout()">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
                <div class="dashboard-content" id="doctor-dashboard-content">
                    <!-- Content will be dynamically loaded -->
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================
         ADMIN DASHBOARD (No chatbot)
         ============================================ -->
    <div id="admin-dashboard" class="page">
        <div class="dashboard-container">
            <div class="dashboard-sidebar">
                <div class="sidebar-header">
                    <h3 id="admin-name">Administrator</h3>
                    <p>Admin Portal</p>
                </div>
                <div class="sidebar-content">
                    <div class="menu-item active" onclick="showAdminSection('overview')">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="menu-item" onclick="showAdminSection('users')">
                        <i class="fas fa-users"></i>
                        <span>User Management</span>
                    </div>
                    <div class="menu-item" onclick="showAdminSection('doctors')">
                        <i class="fas fa-user-md"></i>
                        <span>Doctor Management</span>
                    </div>
                    <div class="menu-item" onclick="showAdminSection('appointments')">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Appointments</span>
                    </div>
                    <div class="menu-item" onclick="showAdminSection('analytics')">
                        <i class="fas fa-chart-bar"></i>
                        <span>Analytics</span>
                    </div>
                    <div class="menu-item" onclick="showAdminSection('logs')">
                        <i class="fas fa-file-alt"></i>
                        <span>System Logs</span>
                    </div>
                </div>
                <div style="padding: 1rem;">
                    <button class="logout-btn" onclick="handleLogout()" style="width: 100%;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
            <div class="dashboard-main">
                <div class="dashboard-topbar">
                    <div class="topbar-left">
                        <div class="topbar-greeting">
                            <h2>Welcome, <span id="admin-welcome-name">Administrator</span>!</h2>
                            <p id="admin-current-date"></p>
                        </div>
                    </div>
                    <div class="topbar-right">
                        <button class="notification-btn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge"></span>
                        </button>
                        <button class="logout-btn" onclick="handleLogout()">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
                <div class="dashboard-content" id="admin-dashboard-content">
                    <!-- Content will be dynamically loaded -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // DATABASE - Embedded Data
        // ============================================
        // ============================================
        // LOGIN CREDENTIALS FOR TESTING
        // ============================================
        // DOCTOR LOGIN:
        //   Username/ID: dr.smith, dr.johnson, dr.williams, dr.brown, dr.davis
        //   Password: doctor123
        //
        // ADMIN LOGIN:
        //   Email/Username: admin.smith OR robert.smith@careconnect.com
        //   Email/Username: admin.johnson OR maria.johnson@careconnect.com
        //   Password: admin123
        //
        // PATIENT LOGIN:
        //   Username: john.doe, jane.smith
        //   Password: patient123
        // ============================================

        const DATABASE = {
            doctors: [
                {
                    id: "DOC001",
                    username: "dr.smith",
                    password: "doctor123",
                    name: "Sarah Smith",
                    email: "sarah.smith@careconnect.com",
                    phone: "+1-555-0101",
                    specialization: "Cardiology",
                    experience: "15 years",
                    qualification: "MD, FACC",
                    department: "Cardiology",
                    schedule: "Mon-Fri 9AM-5PM",
                    status: "active"
                },
                {
                    id: "DOC002",
                    username: "dr.johnson",
                    password: "doctor123",
                    name: "Michael Johnson",
                    email: "michael.johnson@careconnect.com",
                    phone: "+1-555-0102",
                    specialization: "Radiology",
                    experience: "12 years",
                    qualification: "MD, FRCR",
                    department: "Radiology",
                    schedule: "Mon-Fri 8AM-4PM",
                    status: "active"
                },
                {
                    id: "DOC003",
                    username: "dr.williams",
                    password: "doctor123",
                    name: "Emily Williams",
                    email: "emily.williams@careconnect.com",
                    phone: "+1-555-0103",
                    specialization: "Neurology",
                    experience: "18 years",
                    qualification: "MD, FAAN",
                    department: "Neurology",
                    schedule: "Mon-Fri 7AM-3PM",
                    status: "active"
                },
                {
                    id: "DOC004",
                    username: "dr.brown",
                    password: "doctor123",
                    name: "David Brown",
                    email: "david.brown@careconnect.com",
                    phone: "+1-555-0104",
                    specialization: "Pulmonology",
                    experience: "10 years",
                    qualification: "MD, FCCP",
                    department: "Pulmonology",
                    schedule: "Mon-Fri 9AM-5PM",
                    status: "active"
                },
                {
                    id: "DOC005",
                    username: "dr.davis",
                    password: "doctor123",
                    name: "Jennifer Davis",
                    email: "jennifer.davis@careconnect.com",
                    phone: "+1-555-0105",
                    specialization: "General Medicine",
                    experience: "8 years",
                    qualification: "MD",
                    department: "General",
                    schedule: "Mon-Fri 8AM-4PM",
                    status: "active"
                }
            ],
            patients: [
                {
                    id: "PAT001",
                    username: "john.doe",
                    password: "patient123",
                    name: "John Doe",
                    email: "john.doe@email.com",
                    phone: "+1-555-1001",
                    dateOfBirth: "1985-03-15",
                    gender: "Male",
                    address: "123 Main St, City, State 12345",
                    emergencyContact: "Jane Doe - +1-555-1002",
                    bloodType: "O+",
                    allergies: ["Penicillin", "Shellfish"],
                    medicalHistory: ["Hypertension", "Diabetes Type 2"],
                    conditions: ["Diabetes", "Hypertension"],
                    currentMedications: ["Metformin", "Lisinopril"],
                    primaryDoctor: "DOC001",
                    insuranceProvider: "Blue Cross Blue Shield",
                    insuranceNumber: "BC123456789",
                    status: "active",
                    symptoms: ["Frequent urination", "Increased thirst", "Fatigue", "Blurred vision"],
                    testResults: {
                        bloodSugar: "140 mg/dL",
                        hba1c: "6.8%",
                        bloodPressure: "150/95 mmHg",
                        cholesterol: "220 mg/dL",
                        triglycerides: "180 mg/dL",
                        lastUpdated: "2024-01-10"
                    },
                    vitalSigns: {
                        height: "5'10\"",
                        weight: "180 lbs",
                        bmi: "25.8",
                        temperature: "98.6F",
                        pulse: "72 bpm",
                        lastUpdated: "2024-01-15"
                    }
                },
                {
                    id: "PAT002",
                    username: "jane.smith",
                    password: "patient123",
                    name: "Jane Smith",
                    email: "jane.smith@email.com",
                    phone: "+1-555-1003",
                    dateOfBirth: "1990-07-22",
                    gender: "Female",
                    address: "456 Oak Ave, City, State 12345",
                    emergencyContact: "Bob Smith - +1-555-1004",
                    bloodType: "A+",
                    allergies: ["Latex"],
                    medicalHistory: ["Asthma"],
                    conditions: ["Respiratory"],
                    currentMedications: ["Albuterol"],
                    primaryDoctor: "DOC004",
                    insuranceProvider: "Aetna",
                    insuranceNumber: "AE987654321",
                    status: "active",
                    symptoms: ["Wheezing", "Shortness of breath", "Chest tightness"],
                    testResults: {
                        lungFunction: "85%",
                        oxygenSaturation: "96%",
                        bloodPressure: "120/80 mmHg",
                        lastUpdated: "2024-01-12"
                    },
                    vitalSigns: {
                        height: "5'6\"",
                        weight: "140 lbs",
                        bmi: "22.6",
                        temperature: "98.4F",
                        pulse: "68 bpm",
                        lastUpdated: "2024-01-12"
                    }
                }
            ],
            administrators: [
                {
                    id: "ADM001",
                    username: "admin.smith",
                    password: "admin123",
                    name: "Robert Smith",
                    email: "robert.smith@careconnect.com",
                    phone: "+1-555-2001",
                    role: "Hospital Administrator",
                    department: "Administration",
                    permissions: ["manage_users", "view_reports", "system_config", "financial_access"],
                    hireDate: "2018-01-15",
                    status: "active"
                },
                {
                    id: "ADM002",
                    username: "admin.johnson",
                    password: "admin123",
                    name: "Maria Johnson",
                    email: "maria.johnson@careconnect.com",
                    phone: "+1-555-2002",
                    role: "IT Administrator",
                    department: "Information Technology",
                    permissions: ["system_config", "user_management", "data_access"],
                    hireDate: "2019-03-20",
                    status: "active"
                }
            ]
        };

        // ============================================
        // ROUTING & PAGE MANAGEMENT
        // ============================================
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // Handle chatbot visibility based on page and minimized state
            const chatbot = document.getElementById('chatbot-container');
            const floatingIcon = document.getElementById('chatbot-floating-icon');
            if (pageId === 'patient-dashboard') {
                // On patient dashboard - respect minimized state
                if (chatbotMinimized) {
                    // If minimized, hide chatbot and show floating icon
                    if (chatbot) {
                        chatbot.style.display = 'none';
                    }
                    if (floatingIcon) {
                        floatingIcon.style.display = 'flex';
                    }
                } else {
                    // If not minimized, show chatbot and hide floating icon
                    if (chatbot) {
                        chatbot.style.display = 'flex';
                        chatbot.classList.remove('minimized');
                    }
                    if (floatingIcon) {
                        floatingIcon.style.display = 'none';
                        floatingIcon.classList.remove('show');
                    }
                }
            } else {
                // On non-patient-dashboard pages, hide both
                if (chatbot) {
                    chatbot.style.display = 'none';
                }
                if (floatingIcon) {
                    floatingIcon.style.display = 'none';
                }
            }
        }

        // ============================================
        // AUTHENTICATION FUNCTIONS
        // ============================================
        let currentLoginRole = 'patient';

        function switchRole(role) {
            currentLoginRole = role;
            
            // Update tabs
            document.querySelectorAll('.role-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(`tab-${role}`).classList.add('active');
            
            // Show/hide forms
            document.getElementById('login-form-patient').style.display = role === 'patient' ? 'block' : 'none';
            document.getElementById('login-form-doctor').style.display = role === 'doctor' ? 'block' : 'none';
            document.getElementById('login-form-admin').style.display = role === 'admin' ? 'block' : 'none';
            
            // Clear error messages
            document.getElementById('login-error').classList.remove('show');
        }

        function handleUnifiedLogin(event, role) {
            event.preventDefault();
            const errorDiv = document.getElementById('login-error');
            errorDiv.classList.remove('show');
            
            if (role === 'patient') {
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;
                
                const patient = DATABASE.patients.find(p => p.username === username && p.password === password);
                
                if (patient) {
                    localStorage.setItem('user', JSON.stringify({
                        id: patient.id,
                        username: patient.username,
                        role: 'patient',
                        name: patient.name,
                        email: patient.email,
                        phone: patient.phone,
                        primaryDoctor: patient.primaryDoctor
                    }));
                    loadPatientDashboard(patient);
                    showPage('patient-dashboard');
                } else {
                    errorDiv.textContent = 'Invalid username or password';
                    errorDiv.classList.add('show');
                }
            } else if (role === 'doctor') {
                const doctorId = document.getElementById('login-doctor-id').value;
                const password = document.getElementById('login-doctor-password').value;
                
                // For doctor, we can use username or ID
                const doctor = DATABASE.doctors.find(d => 
                    (d.username === doctorId || d.id === doctorId) && d.password === password
                );
                
                if (doctor) {
                    localStorage.setItem('user', JSON.stringify({
                        id: doctor.id,
                        username: doctor.username,
                        role: 'doctor',
                        name: doctor.name,
                        email: doctor.email,
                        phone: doctor.phone,
                        specialization: doctor.specialization,
                        department: doctor.department,
                        experience: doctor.experience
                    }));
                    loadDoctorDashboard(doctor);
                    showPage('doctor-dashboard');
                } else {
                    errorDiv.textContent = 'Invalid Doctor ID or password';
                    errorDiv.classList.add('show');
                }
            } else if (role === 'admin') {
                const email = document.getElementById('login-admin-email').value;
                const password = document.getElementById('login-admin-password').value;
                
                const admin = DATABASE.administrators.find(a => 
                    (a.email === email || a.username === email) && a.password === password
                );
                
                if (admin) {
                    localStorage.setItem('user', JSON.stringify({
                        id: admin.id,
                        username: admin.username,
                        role: 'admin',
                        name: admin.name,
                        email: admin.email,
                        phone: admin.phone,
                        adminRole: admin.role,
                        department: admin.department,
                        permissions: admin.permissions
                    }));
                    loadAdminDashboard(admin);
                    showPage('admin-dashboard');
                } else {
                    errorDiv.textContent = 'Invalid admin email or password';
                    errorDiv.classList.add('show');
                }
            }
        }

        function handlePatientLogin(event) {
            event.preventDefault();
            const username = document.getElementById('patient-username').value;
            const password = document.getElementById('patient-password').value;
            const errorDiv = document.getElementById('patient-error');

            const patient = DATABASE.patients.find(p => p.username === username && p.password === password);
            
            if (patient) {
                localStorage.setItem('user', JSON.stringify({
                    id: patient.id,
                    username: patient.username,
                    role: 'patient',
                    name: patient.name,
                    email: patient.email,
                    phone: patient.phone,
                    primaryDoctor: patient.primaryDoctor
                }));
                errorDiv.classList.remove('show');
                loadPatientDashboard(patient);
                showPage('patient-dashboard');
            } else {
                errorDiv.textContent = 'Invalid username or password';
                errorDiv.classList.add('show');
            }
        }

        function handleDoctorLogin(event) {
            event.preventDefault();
            const username = document.getElementById('doctor-username').value;
            const password = document.getElementById('doctor-password').value;
            const errorDiv = document.getElementById('doctor-error');

            const doctor = DATABASE.doctors.find(d => d.username === username && d.password === password);
            
            if (doctor) {
                localStorage.setItem('user', JSON.stringify({
                    id: doctor.id,
                    username: doctor.username,
                    role: 'doctor',
                    name: doctor.name,
                    email: doctor.email,
                    phone: doctor.phone,
                    specialization: doctor.specialization,
                    department: doctor.department,
                    experience: doctor.experience
                }));
                errorDiv.classList.remove('show');
                loadDoctorDashboard(doctor);
                showPage('doctor-dashboard');
            } else {
                errorDiv.textContent = 'Invalid username or password';
                errorDiv.classList.add('show');
            }
        }

        function handleAdminLogin(event) {
            event.preventDefault();
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;
            const errorDiv = document.getElementById('admin-error');

            const admin = DATABASE.administrators.find(a => a.username === username && a.password === password);
            
            if (admin) {
                localStorage.setItem('user', JSON.stringify({
                    id: admin.id,
                    username: admin.username,
                    role: 'admin',
                    name: admin.name,
                    email: admin.email,
                    phone: admin.phone,
                    role: admin.role,
                    department: admin.department,
                    permissions: admin.permissions
                }));
                errorDiv.classList.remove('show');
                loadAdminDashboard(admin);
                showPage('admin-dashboard');
            } else {
                errorDiv.textContent = 'Invalid username or password';
                errorDiv.classList.add('show');
            }
        }

        function handleLogout() {
            localStorage.removeItem('user');
            showPage('home-page');
        }

        // ============================================
        // DASHBOARD LOADING FUNCTIONS
        // ============================================
        function loadPatientDashboard(patient) {
            document.getElementById('patient-name').textContent = patient.name;
            document.getElementById('patient-welcome-name').textContent = patient.name;
            
            // Set current date
            const dateElement = document.getElementById('current-date');
            if (dateElement) {
                dateElement.textContent = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            }
            
            // Load dashboard overview
            const content = document.getElementById('patient-dashboard-content');
            if (content) {
                loadDashboardOverview(patient, content);
            }
        }

        function loadDoctorDashboard(doctor) {
            document.getElementById('doctor-name').textContent = `Dr. ${doctor.name}`;
            document.getElementById('doctor-welcome-name').textContent = doctor.name;
            
            // Set current date
            const dateElement = document.getElementById('doctor-current-date');
            if (dateElement) {
                dateElement.textContent = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            }
            
            // Load overview by default
            showDoctorSection('overview');
        }

        function showDoctorSection(section) {
            document.querySelectorAll('#doctor-sidebar .menu-item').forEach(item => {
                item.classList.remove('active');
            });
            if (event && event.target.closest('.menu-item')) {
                event.target.closest('.menu-item').classList.add('active');
            }
            
            const content = document.getElementById('doctor-dashboard-content');
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            const doctor = DATABASE.doctors.find(d => d.id === user.id);
            
            if (!doctor) return;
            
            switch(section) {
                case 'overview':
                    loadDoctorOverview(doctor, content);
                    break;
                case 'patients':
                    loadDoctorPatients(doctor, content);
                    break;
                case 'appointments':
                    loadDoctorAppointments(doctor, content);
                    break;
                case 'reports':
                    loadDoctorReports(doctor, content);
                    break;
                case 'messages':
                    loadDoctorMessages(doctor, content);
                    break;
                case 'prescriptions':
                    loadDoctorPrescriptions(doctor, content);
                    break;
                case 'case-notes':
                    loadDoctorCaseNotes(doctor, content);
                    break;
            }
        }

        function loadDoctorOverview(doctor, content) {
            const assignedPatients = DATABASE.patients.filter(p => p.primaryDoctor === doctor.id);
            const pendingReports = 3;
            const unreadMessages = 2;
            const todayAppointments = 4;
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Doctor Dashboard</h1>
                    <p>Overview of your practice and patient care</p>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-users"></i>
                                Assigned Patients
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 36px; font-weight: 700; color: var(--primary-blue); margin-bottom: 8px;">${assignedPatients.length}</div>
                            <p style="color: var(--text-gray);">Patients under your care</p>
                            <button class="btn-sm btn-outline" style="margin-top: 16px; width: 100%;" onclick="showDoctorSection('patients')">View All Patients</button>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-file-medical-alt"></i>
                                Pending Reports
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 36px; font-weight: 700; color: #FF4444; margin-bottom: 8px;">${pendingReports}</div>
                            <p style="color: var(--text-gray);">Reports awaiting review</p>
                            <button class="btn-sm btn-outline" style="margin-top: 16px; width: 100%;" onclick="showDoctorSection('reports')">Review Reports</button>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-calendar-check"></i>
                                Today's Appointments
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 36px; font-weight: 700; color: var(--primary-green); margin-bottom: 8px;">${todayAppointments}</div>
                            <p style="color: var(--text-gray);">Scheduled for today</p>
                            <button class="btn-sm btn-outline" style="margin-top: 16px; width: 100%;" onclick="showDoctorSection('appointments')">View Calendar</button>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-envelope"></i>
                                Unread Messages
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 36px; font-weight: 700; color: #FF4444; margin-bottom: 8px;">${unreadMessages}</div>
                            <p style="color: var(--text-gray);">Messages from patients</p>
                            <button class="btn-sm btn-outline" style="margin-top: 16px; width: 100%;" onclick="showDoctorSection('messages')">View Messages</button>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card" style="margin-top: 24px;">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-clock"></i>
                            Upcoming Appointments
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="appointment-list">
                            ${[
                                { time: '9:00 AM', patient: 'John Doe', type: 'Follow-up' },
                                { time: '10:30 AM', patient: 'Jane Smith', type: 'Consultation' },
                                { time: '2:00 PM', patient: 'Mike Johnson', type: 'Review' }
                            ].map(apt => `
                                <div class="appointment-card-item">
                                    <div class="appointment-date">
                                        <i class="fas fa-clock"></i> Today at ${apt.time}
                                    </div>
                                    <div class="appointment-details">
                                        <div><strong>Patient:</strong> ${apt.patient}</div>
                                        <div><strong>Type:</strong> ${apt.type}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function loadDoctorPatients(doctor, content) {
            const assignedPatients = DATABASE.patients.filter(p => p.primaryDoctor === doctor.id);
            if (assignedPatients.length === 0) {
                assignedPatients.push(...DATABASE.patients.slice(0, 8));
            }
            
            // Add mock data for status and last visit
            const patientsWithStatus = assignedPatients.map((patient, index) => {
                const statuses = ['Stable', 'Needs Attention', 'Critical'];
                const status = index % 3 === 0 ? 'Stable' : (index % 3 === 1 ? 'Needs Attention' : 'Critical');
                const lastVisit = new Date();
                lastVisit.setDate(lastVisit.getDate() - (index * 7 + 3));
                return {
                    ...patient,
                    status: status,
                    lastVisit: lastVisit.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })
                };
            });
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Assigned Patients</h1>
                    <p>Manage your patient roster and view case details</p>
                </div>

                <div class="search-filter-bar">
                    <input type="text" class="search-input" placeholder="Search patients by name, condition, or ID..." id="patient-search" onkeyup="filterPatients()">
                    <select class="filter-select" id="status-filter" onchange="filterPatients()">
                        <option value="all">All Status</option>
                        <option value="Stable">Stable</option>
                        <option value="Needs Attention">Needs Attention</option>
                        <option value="Critical">Critical</option>
                    </select>
                </div>

                <div class="dashboard-grid" id="patients-grid">
                    ${patientsWithStatus.map(patient => {
                        const statusClass = patient.status === 'Stable' ? 'status-stable' : 
                                          patient.status === 'Needs Attention' ? 'status-attention' : 'status-critical';
                        return `
                            <div class="patient-card-enhanced" data-status="${patient.status}" data-name="${patient.name.toLowerCase()}">
                                <div class="patient-card-header">
                                    <div>
                                        <div class="patient-card-name">${patient.name}</div>
                                        <div class="patient-card-info">
                                            ${new Date().getFullYear() - new Date(patient.dateOfBirth).getFullYear()} years  ${patient.gender}  ${patient.bloodType}
                                        </div>
                                    </div>
                                    <span class="status-badge ${statusClass}">${patient.status}</span>
                                </div>
                                <div style="margin-bottom: 12px;">
                                    <strong>Condition/Diagnosis:</strong><br>
                                    <span style="color: var(--text-gray);">${patient.conditions && patient.conditions.length > 0 ? patient.conditions.join(', ') : 'No active conditions'}</span>
                                </div>
                                <div style="margin-bottom: 16px; font-size: 14px; color: var(--text-gray);">
                                    <i class="fas fa-calendar"></i> Last Visit: ${patient.lastVisit}
                                </div>
                                <button class="btn-sm btn-outline" style="width: 100%;" onclick="showPatientDetailsForDoctor('${patient.id}')">
                                    <i class="fas fa-eye"></i> View Case
                                </button>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function filterPatients() {
            const searchTerm = document.getElementById('patient-search')?.value.toLowerCase() || '';
            const statusFilter = document.getElementById('status-filter')?.value || 'all';
            const grid = document.getElementById('patients-grid');
            if (!grid) return;
            
            const cards = grid.querySelectorAll('.patient-card-enhanced');
            cards.forEach(card => {
                const name = card.getAttribute('data-name') || '';
                const status = card.getAttribute('data-status') || '';
                const matchesSearch = name.includes(searchTerm);
                const matchesStatus = statusFilter === 'all' || status === statusFilter;
                
                card.style.display = (matchesSearch && matchesStatus) ? 'block' : 'none';
            });
        }


        function loadDoctorAppointments(doctor, content) {
            const today = new Date();
            const appointments = [
                { date: today.toISOString().split('T')[0], time: '9:00 AM', patient: 'John Doe', reason: 'Diabetes monitoring', department: 'Cardiology', location: 'Room 205' },
                { date: today.toISOString().split('T')[0], time: '10:30 AM', patient: 'Jane Smith', reason: 'Asthma review', department: 'Pulmonology', location: 'Room 210' },
                { date: today.toISOString().split('T')[0], time: '2:00 PM', patient: 'Mike Johnson', reason: 'Cholesterol check', department: 'Cardiology', location: 'Room 205' },
                { date: today.toISOString().split('T')[0], time: '3:30 PM', patient: 'Sarah Williams', reason: 'Routine exam', department: 'General', location: 'Room 201' },
                { date: new Date(today.getTime() + 86400000).toISOString().split('T')[0], time: '9:00 AM', patient: 'John Doe', reason: 'Follow-up', department: 'Cardiology', location: 'Room 205' },
                { date: new Date(today.getTime() + 86400000).toISOString().split('T')[0], time: '11:00 AM', patient: 'Jane Smith', reason: 'Medication review', department: 'Pulmonology', location: 'Room 210' }
            ];
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Appointment Calendar</h1>
                    <p>Manage your appointments and schedule</p>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 350px; gap: 24px;">
                    <div>
                        <div class="dashboard-card" style="margin-bottom: 24px;">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-calendar-alt"></i>
                                    Today's Appointments - ${today.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' })}
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="appointment-list">
                                    ${appointments.filter(apt => apt.date === today.toISOString().split('T')[0]).map(apt => `
                                        <div class="appointment-card-item">
                                            <div class="appointment-date">
                                                <i class="fas fa-clock"></i> ${apt.time}
                                            </div>
                                            <div class="appointment-details">
                                                <div><strong>Patient:</strong> ${apt.patient}</div>
                                                <div><strong>Reason:</strong> ${apt.reason}</div>
                                                <div><strong>Department:</strong> ${apt.department}</div>
                                                <div><strong>Location:</strong> ${apt.location}</div>
                                            </div>
                                            <button class="btn-sm btn-outline" onclick="alert('Open appointment feature coming soon')">
                                                <i class="fas fa-external-link-alt"></i> Open Appointment
                                            </button>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>

                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-calendar-week"></i>
                                    Upcoming Appointments
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="appointment-list">
                                    ${appointments.filter(apt => apt.date !== today.toISOString().split('T')[0]).map(apt => {
                                        const aptDate = new Date(apt.date);
                                        return `
                                            <div class="appointment-card-item">
                                                <div class="appointment-date">
                                                    <i class="fas fa-calendar"></i> ${aptDate.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })} at ${apt.time}
                                                </div>
                                                <div class="appointment-details">
                                                    <div><strong>Patient:</strong> ${apt.patient}</div>
                                                    <div><strong>Reason:</strong> ${apt.reason}</div>
                                                    <div><strong>Location:</strong> ${apt.location}</div>
                                                </div>
                                                <button class="btn-sm btn-outline" onclick="alert('Open appointment feature coming soon')">Open</button>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="dashboard-card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fas fa-calendar"></i>
                                    Calendar
                                </div>
                            </div>
                            <div class="card-body">
                                ${generateMiniCalendar()}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateMiniCalendar() {
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            
            let calendarHTML = '<div class="mini-calendar">';
            
            // Header
            days.forEach(day => {
                calendarHTML += `<div class="calendar-header">${day}</div>`;
            });
            
            // Empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                calendarHTML += '<div class="calendar-day other-month"></div>';
            }
            
            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = day === today.getDate();
                const classes = `calendar-day ${isToday ? 'today' : ''}`;
                calendarHTML += `<div class="${classes}">${day}</div>`;
            }
            
            calendarHTML += '</div>';
            return calendarHTML;
        }

        function loadDoctorReports(doctor, content) {
            const pendingReports = [
                { 
                    type: 'Lab Results', 
                    patient: 'John Doe', 
                    report: 'Complete Blood Count (CBC)', 
                    date: '2024-02-12', 
                    priority: 'High',
                    alert: 'Abnormal: Elevated WBC count',
                    status: 'Awaiting Approval'
                },
                { 
                    type: 'Imaging Report', 
                    patient: 'Jane Smith', 
                    report: 'Chest X-Ray', 
                    date: '2024-02-11', 
                    priority: 'Medium',
                    alert: null,
                    status: 'Pending Signature'
                },
                { 
                    type: 'Lab Results', 
                    patient: 'Mike Johnson', 
                    report: 'Lipid Panel', 
                    date: '2024-02-10', 
                    priority: 'High',
                    alert: 'Abnormal: High cholesterol levels',
                    status: 'Awaiting Review'
                },
                { 
                    type: 'Refill Request', 
                    patient: 'John Doe', 
                    report: 'Metformin 500mg Refill Request', 
                    date: '2024-02-12', 
                    priority: 'Low',
                    alert: null,
                    status: 'Pending Approval'
                },
                { 
                    type: 'Imaging Report', 
                    patient: 'Sarah Williams', 
                    report: 'MRI Brain Scan', 
                    date: '2024-02-09', 
                    priority: 'Medium',
                    alert: null,
                    status: 'Pending Signature'
                }
            ];
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Pending Reports to Review</h1>
                    <p>Lab results, imaging reports, and refill requests awaiting your approval</p>
                </div>

                <div class="search-filter-bar">
                    <input type="text" class="search-input" placeholder="Search reports..." id="report-search">
                    <select class="filter-select" id="report-type-filter">
                        <option value="all">All Types</option>
                        <option value="Lab Results">Lab Results</option>
                        <option value="Imaging Report">Imaging Reports</option>
                        <option value="Refill Request">Refill Requests</option>
                    </select>
                    <select class="filter-select" id="report-priority-filter">
                        <option value="all">All Priorities</option>
                        <option value="High">High</option>
                        <option value="Medium">Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>

                <div class="dashboard-card">
                    <div class="card-body">
                        ${pendingReports.map(report => {
                            const priorityClass = report.priority === 'High' ? 'priority-high' : 
                                                report.priority === 'Medium' ? 'priority-medium' : 'priority-low';
                            return `
                                <div class="query-item" style="${report.alert ? 'border-left-color: #FF4444; background: #FFF5F5;' : ''}">
                                    <div class="query-header">
                                        <div style="flex: 1;">
                                            <div class="query-title">
                                                <i class="fas fa-${report.type === 'Lab Results' ? 'vial' : report.type === 'Imaging Report' ? 'x-ray' : 'prescription-bottle-alt'}"></i>
                                                ${report.report}
                                            </div>
                                            <p style="font-size: 14px; color: var(--text-gray); margin: 4px 0 0 0;">
                                                <strong>Patient:</strong> ${report.patient}  
                                                <strong>Type:</strong> ${report.type}  
                                                <strong>Date:</strong> ${report.date}
                                            </p>
                                            ${report.alert ? `
                                                <div style="margin-top: 8px; padding: 8px; background: #FFE5E5; border-radius: 6px; border-left: 3px solid #FF4444;">
                                                    <i class="fas fa-exclamation-triangle" style="color: #FF4444;"></i>
                                                    <strong style="color: #C33;">Alert:</strong> ${report.alert}
                                                </div>
                                            ` : ''}
                                            <p style="font-size: 13px; color: var(--text-gray); margin-top: 8px;">
                                                <strong>Status:</strong> ${report.status}
                                            </p>
                                        </div>
                                        <span class="query-priority ${priorityClass}">${report.priority}</span>
                                    </div>
                                    <div style="margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap;">
                                        <button class="btn-sm btn-outline" onclick="alert('Review and approve report feature coming soon')">
                                            <i class="fas fa-check"></i> Review & Approve
                                        </button>
                                        <button class="btn-sm btn-outline" onclick="alert('View full report feature coming soon')">
                                            <i class="fas fa-eye"></i> View Full Report
                                        </button>
                                        <button class="btn-sm btn-outline" onclick="alert('Download report feature coming soon')">
                                            <i class="fas fa-download"></i> Download
                                        </button>
                                        ${report.type === 'Refill Request' ? `
                                            <button class="btn-sm btn-outline" style="background: #FFE5E5; color: #C33;" onclick="alert('Deny refill feature coming soon')">
                                                <i class="fas fa-times"></i> Deny
                                            </button>
                                        ` : ''}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        function loadDoctorMessages(doctor, content) {
            const messages = [
                { 
                    patient: 'John Doe', 
                    subject: 'Question about medication dosage', 
                    message: 'Dr. Smith, I have a question about my Metformin dosage. Should I take it with meals?',
                    date: '2024-02-12 14:30',
                    unread: true,
                    urgent: false
                },
                { 
                    patient: 'Jane Smith', 
                    subject: 'Urgent: Breathing difficulty', 
                    message: 'I\'m experiencing increased wheezing and shortness of breath. Should I use my rescue inhaler more frequently?',
                    date: '2024-02-12 10:15',
                    unread: true,
                    urgent: true
                },
                { 
                    patient: 'Mike Johnson', 
                    subject: 'Follow-up question from last visit', 
                    message: 'Thank you for the consultation. I wanted to clarify about my cholesterol medication schedule.',
                    date: '2024-02-11 16:45',
                    unread: true,
                    urgent: false
                },
                { 
                    patient: 'Sarah Williams', 
                    subject: 'Thank you for the consultation', 
                    message: 'Thank you for taking the time to explain everything during my last visit.',
                    date: '2024-02-10 09:20',
                    unread: false,
                    urgent: false
                },
                { 
                    patient: 'John Doe', 
                    subject: 'Lab results question', 
                    message: 'I received my lab results. Can you help me understand what the elevated values mean?',
                    date: '2024-02-09 11:30',
                    unread: false,
                    urgent: false
                }
            ];
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Messages From Patients</h1>
                    <p>Patient communications and inquiries</p>
                </div>

                <div class="search-filter-bar">
                    <input type="text" class="search-input" placeholder="Search messages..." id="message-search">
                    <select class="filter-select" id="message-filter">
                        <option value="all">All Messages</option>
                        <option value="unread">Unread</option>
                        <option value="urgent">Urgent</option>
                        <option value="read">Read</option>
                    </select>
                </div>

                <div class="dashboard-card">
                    <div class="card-body">
                        ${messages.map(msg => {
                            const isUnread = msg.unread;
                            const isUrgent = msg.urgent;
                            return `
                                <div class="query-item" style="${isUnread ? 'border-left-color: var(--primary-blue); background: var(--soft-blue);' : ''} ${isUrgent ? 'border-left-width: 4px; border-left-color: #FF4444;' : ''}">
                                    <div class="query-header">
                                        <div style="flex: 1;">
                                            <div class="query-title">
                                                ${msg.patient} 
                                                ${isUnread ? '<span style="color: #FF4444; font-size: 12px;"> NEW</span>' : ''}
                                                ${isUrgent ? '<span class="query-priority priority-high" style="margin-left: 8px;">URGENT</span>' : ''}
                                            </div>
                                            <p style="font-size: 14px; font-weight: 600; color: var(--text-dark); margin: 4px 0;">${msg.subject}</p>
                                            <p style="font-size: 14px; color: var(--text-gray); margin: 4px 0 0 0;">${msg.message}</p>
                                            <p style="font-size: 12px; color: var(--text-gray); margin: 8px 0 0 0;">
                                                <i class="fas fa-clock"></i> ${msg.date}
                                            </p>
                                        </div>
                                    </div>
                                    <div style="margin-top: 12px; display: flex; gap: 8px;">
                                        <button class="btn-sm btn-outline" onclick="alert('Open conversation feature coming soon')">
                                            <i class="fas fa-comments"></i> Open Conversation
                                        </button>
                                        <button class="btn-sm btn-outline" onclick="alert('Reply feature coming soon')">
                                            <i class="fas fa-reply"></i> Reply
                                        </button>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;
        }

        function loadDoctorPrescriptions(doctor, content) {
            const prescriptions = [
                { 
                    patient: 'John Doe', 
                    medication: 'Metformin 500mg', 
                    dosage: '500mg',
                    frequency: 'Twice daily with meals',
                    status: 'Active', 
                    refills: 3,
                    refillRequest: true,
                    lastRefill: '2024-01-15',
                    nextRefill: '2024-02-15'
                },
                { 
                    patient: 'Jane Smith', 
                    medication: 'Albuterol Inhaler', 
                    dosage: '90mcg',
                    frequency: 'As needed for shortness of breath',
                    status: 'Active', 
                    refills: 2,
                    refillRequest: false,
                    lastRefill: '2024-01-20',
                    nextRefill: '2024-02-20'
                },
                { 
                    patient: 'Mike Johnson', 
                    medication: 'Atorvastatin 20mg', 
                    dosage: '20mg',
                    frequency: 'Once daily at bedtime',
                    status: 'Active', 
                    refills: 1,
                    refillRequest: true,
                    lastRefill: '2024-01-10',
                    nextRefill: '2024-02-10'
                },
                { 
                    patient: 'Sarah Williams', 
                    medication: 'Lisinopril 10mg', 
                    dosage: '10mg',
                    frequency: 'Once daily',
                    status: 'Active', 
                    refills: 0,
                    refillRequest: false,
                    lastRefill: '2024-01-25',
                    nextRefill: '2024-02-25'
                }
            ];
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Prescription Management</h1>
                    <p>Manage patient prescriptions, refill requests, and medication adjustments</p>
                </div>

                <div class="dashboard-card" style="margin-bottom: 24px;">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-exclamation-circle"></i>
                            Refill Requests Pending Approval
                        </div>
                    </div>
                    <div class="card-body">
                        ${prescriptions.filter(p => p.refillRequest).map(pres => `
                            <div class="medication-item" style="border-left: 4px solid var(--primary-blue); background: var(--soft-blue);">
                                <div class="medication-info" style="flex: 1;">
                                    <h4>${pres.medication}</h4>
                                    <p><strong>Patient:</strong> ${pres.patient}</p>
                                    <p><strong>Dosage:</strong> ${pres.dosage}  <strong>Frequency:</strong> ${pres.frequency}</p>
                                    <p><strong>Refills Remaining:</strong> ${pres.refills}  <strong>Last Refill:</strong> ${pres.lastRefill}</p>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                    <button class="btn-sm btn-outline" style="background: var(--primary-green); color: white; border-color: var(--primary-green);" onclick="alert('Approve refill feature coming soon')">
                                        <i class="fas fa-check"></i> Approve Refill
                                    </button>
                                    <button class="btn-sm btn-outline" style="background: #FFE5E5; color: #C33; border-color: #FFE5E5;" onclick="alert('Deny refill feature coming soon')">
                                        <i class="fas fa-times"></i> Deny
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-prescription-bottle-alt"></i>
                            Active Prescriptions
                        </div>
                    </div>
                    <div class="card-body">
                        ${prescriptions.map(pres => `
                            <div class="medication-item">
                                <div class="medication-info" style="flex: 1;">
                                    <h4>${pres.medication}</h4>
                                    <p><strong>Patient:</strong> ${pres.patient}</p>
                                    <p><strong>Dosage:</strong> ${pres.dosage}</p>
                                    <p><strong>Frequency:</strong> ${pres.frequency}</p>
                                    <p>
                                        <strong>Status:</strong> <span class="badge badge-normal">${pres.status}</span>  
                                        <strong>Refills:</strong> ${pres.refills}  
                                        <strong>Next Refill:</strong> ${pres.nextRefill}
                                    </p>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: 8px;">
                                    <button class="btn-sm btn-outline" onclick="alert('Adjust medication feature coming soon')">
                                        <i class="fas fa-edit"></i> Adjust Medication
                                    </button>
                                    <button class="btn-sm btn-outline" onclick="alert('View medication history feature coming soon')">
                                        <i class="fas fa-history"></i> View History
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function loadDoctorCaseNotes(doctor, content) {
            const caseNotes = [
                { 
                    patient: 'John Doe', 
                    patientId: 'PAT001',
                    date: '2024-02-10', 
                    condition: 'Type 2 Diabetes',
                    summary: 'Patient showing improvement in blood sugar levels. HbA1c decreased from 7.8% to 7.2%. Continue current medication regimen.',
                    lastNote: 'Blood glucose levels stable. Patient reports good adherence to diet and exercise plan. No side effects reported.',
                    status: 'Active'
                },
                { 
                    patient: 'Jane Smith', 
                    patientId: 'PAT002',
                    date: '2024-02-08', 
                    condition: 'Asthma',
                    summary: 'Asthma symptoms well controlled. Patient reports minimal use of rescue inhaler. Peak flow measurements within normal range.',
                    lastNote: 'Patient doing well on current medication. Advised to continue using Albuterol inhaler as needed. Follow-up in 3 months.',
                    status: 'Active'
                },
                { 
                    patient: 'Mike Johnson', 
                    patientId: 'PAT003',
                    date: '2024-02-05', 
                    condition: 'Hyperlipidemia',
                    summary: 'Cholesterol levels improving. Total cholesterol decreased from 240 to 195 mg/dL. Patient responding well to Atorvastatin.',
                    lastNote: 'Lipid panel shows significant improvement. Patient tolerating medication well. Continue current dose.',
                    status: 'Active'
                },
                { 
                    patient: 'Sarah Williams', 
                    patientId: 'PAT004',
                    date: '2024-02-03', 
                    condition: 'Hypertension',
                    summary: 'Blood pressure well controlled on current medication. Average readings: 125/80 mmHg. Patient reports no adverse effects.',
                    lastNote: 'BP stable. Patient advised to continue lifestyle modifications including low-sodium diet and regular exercise.',
                    status: 'Active'
                }
            ];
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Case Notes</h1>
                    <p>View and manage patient case notes and clinical summaries</p>
                </div>

                <div class="dashboard-card">
                    <div class="card-body">
                        ${caseNotes.map(note => `
                            <div class="appointment-history-item" style="margin-bottom: 24px; padding: 20px; border: 1px solid var(--border-color); border-radius: 12px;">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                                    <div>
                                        <div style="font-size: 18px; font-weight: 600; color: var(--text-dark); margin-bottom: 4px;">
                                            ${note.patient}
                                        </div>
                                        <div style="font-size: 14px; color: var(--text-gray);">
                                            <i class="fas fa-calendar"></i> Last Updated: ${note.date}  
                                            <i class="fas fa-stethoscope"></i> Condition: ${note.condition}
                                        </div>
                                    </div>
                                    <span class="status-badge status-stable">${note.status}</span>
                                </div>
                                
                                <div style="margin-bottom: 16px;">
                                    <h4 style="font-size: 14px; font-weight: 600; color: var(--text-dark); margin-bottom: 8px;">
                                        <i class="fas fa-file-medical"></i> Current Condition Summary:
                                    </h4>
                                    <p style="color: var(--text-gray); line-height: 1.6;">${note.summary}</p>
                                </div>
                                
                                <div style="margin-bottom: 16px; padding: 12px; background: var(--light-gray); border-radius: 8px;">
                                    <h4 style="font-size: 14px; font-weight: 600; color: var(--text-dark); margin-bottom: 8px;">
                                        <i class="fas fa-sticky-note"></i> Doctor's Last Note:
                                    </h4>
                                    <p style="color: var(--text-gray); line-height: 1.6;">${note.lastNote}</p>
                                </div>
                                
                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    <button class="btn-sm btn-outline" onclick="showAddClinicalNote('${note.patientId}', '${note.patient}')">
                                        <i class="fas fa-plus"></i> Add Clinical Note
                                    </button>
                                    <button class="btn-sm btn-outline" onclick="alert('View full case history feature coming soon')">
                                        <i class="fas fa-history"></i> View Full History
                                    </button>
                                    <button class="btn-sm btn-outline" onclick="showPatientDetailsForDoctor('${note.patientId}')">
                                        <i class="fas fa-user"></i> View Patient Details
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function showAddClinicalNote(patientId, patientName) {
            const note = prompt(`Add clinical note for ${patientName}:`);
            if (note) {
                alert('Clinical note added successfully! (Feature in development)');
            }
        }


        function showPatientDetailsForDoctor(patientId) {
            const patient = DATABASE.patients.find(p => p.id === patientId);
            if (patient) {
                showPatientDetails(patient);
                showDoctorSection('patients');
            }
        }

        function showPatientDetails(patient) {
            const content = document.getElementById('doctor-dashboard-content');
            content.innerHTML = `
                <div class="page-header">
                    <h1>${patient.name}</h1>
                    <p>Patient Details and Medical Information</p>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card" style="grid-column: 1 / -1;">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-user"></i>
                                Patient Information
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                                <div><strong>Age:</strong> ${new Date().getFullYear() - new Date(patient.dateOfBirth).getFullYear()} years</div>
                                <div><strong>Gender:</strong> ${patient.gender}</div>
                                <div><strong>Blood Type:</strong> ${patient.bloodType}</div>
                                <div><strong>Email:</strong> ${patient.email}</div>
                                <div><strong>Phone:</strong> ${patient.phone}</div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-exclamation-triangle"></i>
                                Current Symptoms
                            </div>
                        </div>
                        <div class="card-body">
                            ${patient.symptoms && patient.symptoms.length > 0 ? 
                                patient.symptoms.map(s => `<div style="padding: 8px; background: var(--light-gray); border-radius: 8px; margin-bottom: 8px;">${s}</div>`).join('') : 
                                '<p>No symptoms reported</p>'
                            }
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-vial"></i>
                                Test Results
                            </div>
                        </div>
                        <div class="card-body">
                            ${Object.entries(patient.testResults || {}).filter(([k]) => k !== 'lastUpdated').map(([key, value]) => 
                                `<div style="padding: 12px; background: var(--light-gray); border-radius: 8px; margin-bottom: 8px;">
                                    <div style="font-weight: 600; margin-bottom: 4px;">${key.replace(/([A-Z])/g, ' $1').trim()}</div>
                                    <div style="color: var(--text-gray);">${value}</div>
                                </div>`
                            ).join('')}
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-pills"></i>
                                Current Medications
                            </div>
                        </div>
                        <div class="card-body">
                            ${patient.currentMedications && patient.currentMedications.length > 0 ? 
                                patient.currentMedications.map(m => `<div style="padding: 8px; background: var(--light-gray); border-radius: 8px; margin-bottom: 8px;">${m}</div>`).join('') : 
                                '<p>No medications</p>'
                            }
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-history"></i>
                                Medical History
                            </div>
                        </div>
                        <div class="card-body">
                            ${patient.medicalHistory && patient.medicalHistory.length > 0 ? 
                                patient.medicalHistory.map(h => `<div style="padding: 8px; background: var(--light-gray); border-radius: 8px; margin-bottom: 8px;">${h}</div>`).join('') : 
                                '<p>No medical history recorded</p>'
                            }
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-allergies"></i>
                                Allergies
                            </div>
                        </div>
                        <div class="card-body">
                            ${patient.allergies && patient.allergies.length > 0 ? 
                                patient.allergies.map(a => `<div style="padding: 8px; background: #FFE5E5; border-radius: 8px; margin-bottom: 8px; color: #C33;">${a}</div>`).join('') : 
                                '<p>No known allergies</p>'
                            }
                        </div>
                    </div>
                </div>

                <div style="margin-top: 24px; display: flex; gap: 12px;">
                    <button class="btn btn-primary" onclick="alert('Add case note feature coming soon')">
                        <i class="fas fa-sticky-note"></i> Add Case Note
                    </button>
                    <button class="btn btn-secondary" onclick="alert('Prescribe medication feature coming soon')">
                        <i class="fas fa-prescription"></i> Prescribe Medication
                    </button>
                    <button class="btn btn-secondary" onclick="alert('Message patient feature coming soon')">
                        <i class="fas fa-envelope"></i> Message Patient
                    </button>
                </div>
            `;
        }


        function loadAdminDashboard(admin) {
            document.getElementById('admin-name').textContent = admin.name;
            document.getElementById('admin-welcome-name').textContent = admin.name;
            
            // Set current date
            const dateElement = document.getElementById('admin-current-date');
            if (dateElement) {
                dateElement.textContent = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            }
            
            // Load overview by default
            showAdminSection('overview');
        }

        function showAdminSection(section) {
            document.querySelectorAll('#admin-dashboard .menu-item').forEach(item => {
                item.classList.remove('active');
            });
            if (event && event.target.closest('.menu-item')) {
                event.target.closest('.menu-item').classList.add('active');
            }
            
            const content = document.getElementById('admin-dashboard-content');
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            const admin = DATABASE.administrators.find(a => a.id === user.id);
            
            if (!admin) return;
            
            switch(section) {
                case 'overview':
                    loadAdminOverview(admin, content);
                    break;
                case 'users':
                    loadAdminUsers(admin, content);
                    break;
                case 'doctors':
                    loadAdminDoctors(admin, content);
                    break;
                case 'appointments':
                    loadAdminAppointments(admin, content);
                    break;
                case 'analytics':
                    loadAdminAnalytics(admin, content);
                    break;
                case 'logs':
                    loadAdminLogs(admin, content);
                    break;
            }
        }

        function loadAdminOverview(admin, content) {
            const stats = {
                total: DATABASE.patients.length,
                active: DATABASE.patients.filter(p => p.status === 'active').length,
                doctors: DATABASE.doctors.length,
                admins: DATABASE.administrators.length,
                appointments: 24,
                messages: 8,
                todayLogins: 156,
                noShowRate: 8.5,
                mostRequestedDept: 'Cardiology'
            };

            content.innerHTML = `
                <div class="page-header">
                    <h1>Administration Dashboard</h1>
                    <p>System overview and management</p>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-users"></i>
                                Total Patients
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 36px; font-weight: 700; color: var(--primary-blue); margin-bottom: 8px;">${stats.total}</div>
                            <p style="color: var(--text-gray);">${stats.active} active</p>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-user-md"></i>
                                Doctors
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 36px; font-weight: 700; color: var(--primary-green); margin-bottom: 8px;">${stats.doctors}</div>
                            <p style="color: var(--text-gray);">Active physicians</p>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-calendar-check"></i>
                                Today's Appointments
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 36px; font-weight: 700; color: var(--primary-blue); margin-bottom: 8px;">${stats.appointments}</div>
                            <p style="color: var(--text-gray);">Scheduled today</p>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-sign-in-alt"></i>
                                Daily Logins
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 36px; font-weight: 700; color: var(--primary-green); margin-bottom: 8px;">${stats.todayLogins}</div>
                            <p style="color: var(--text-gray);">Today's user logins</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid" style="margin-top: 24px;">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-line"></i>
                                System Metrics
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>No-Show Rate</span>
                                    <strong>${stats.noShowRate}%</strong>
                                </div>
                                <div style="height: 8px; background: var(--light-gray); border-radius: 4px; overflow: hidden;">
                                    <div style="height: 100%; width: ${stats.noShowRate}%; background: ${stats.noShowRate > 10 ? '#FF4444' : '#4CAF50'};"></div>
                                </div>
                            </div>
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Most Requested Department</span>
                                    <strong>${stats.mostRequestedDept}</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-bell"></i>
                                Recent Alerts
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 14px; line-height: 1.8;">
                                <div style="padding: 8px; background: #FFF5F5; border-left: 3px solid #FF4444; margin-bottom: 8px; border-radius: 4px;">
                                    <i class="fas fa-exclamation-triangle" style="color: #FF4444;"></i> 3 appointments cancelled today
                                </div>
                                <div style="padding: 8px; background: #E8F5E9; border-left: 3px solid #4CAF50; margin-bottom: 8px; border-radius: 4px;">
                                    <i class="fas fa-check-circle" style="color: #4CAF50;"></i> System backup completed successfully
                                </div>
                                <div style="padding: 8px; background: #FFF3CD; border-left: 3px solid #FFC107; border-radius: 4px;">
                                    <i class="fas fa-info-circle" style="color: #FFC107;"></i> 5 new patient registrations today
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function loadAdminUsers(admin, content) {
            const allUsers = [...DATABASE.patients, ...DATABASE.doctors];
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>User Management</h1>
                    <p>Manage patient and doctor accounts and access</p>
                </div>

                <div class="search-filter-bar">
                    <input type="text" class="search-input" placeholder="Search users by name, email, or ID..." id="user-search" onkeyup="filterUsers()">
                    <select class="filter-select" id="user-type-filter" onchange="filterUsers()">
                        <option value="all">All Users</option>
                        <option value="patient">Patients</option>
                        <option value="doctor">Doctors</option>
                    </select>
                    <select class="filter-select" id="user-status-filter" onchange="filterUsers()">
                        <option value="all">All Status</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-users"></i>
                            All Users (${allUsers.length})
                        </div>
                        <button class="btn-sm btn-outline" onclick="alert('Add user feature coming soon')">
                            <i class="fas fa-plus"></i> Add User
                        </button>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem;" id="users-grid">
                            ${allUsers.map(user => {
                                const isDoctor = user.specialization || user.department;
                                return `
                                    <div class="patient-card-enhanced" data-type="${isDoctor ? 'doctor' : 'patient'}" data-status="${user.status || 'active'}" data-name="${user.name.toLowerCase()}">
                                        <div class="patient-card-header">
                                            <div>
                                                <div class="patient-card-name">
                                                    ${isDoctor ? '<i class="fas fa-user-md"></i>' : '<i class="fas fa-user"></i>'} ${user.name}
                                                </div>
                                                <div class="patient-card-info">
                                                    ${user.email}  ${user.phone || 'N/A'}
                                                </div>
                                                ${isDoctor ? `<div style="font-size: 13px; color: var(--primary-blue); margin-top: 4px;">
                                                    <i class="fas fa-stethoscope"></i> ${user.specialization || user.department}
                                                </div>` : ''}
                                            </div>
                                            <span class="status-badge ${(user.status || 'active') === 'active' ? 'status-stable' : 'status-attention'}">
                                                ${user.status || 'active'}
                                            </span>
                                        </div>
                                        <div style="margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap;">
                                            <button class="btn-sm btn-outline" onclick="alert('View user details feature coming soon')">
                                                <i class="fas fa-eye"></i> View
                                            </button>
                                            <button class="btn-sm btn-outline" onclick="alert('Edit user feature coming soon')">
                                                <i class="fas fa-edit"></i> Edit
                                            </button>
                                            <button class="btn-sm btn-outline" style="background: ${(user.status || 'active') === 'active' ? '#FFE5E5' : '#E8F5E9'}; color: ${(user.status || 'active') === 'active' ? '#C33' : '#2E7D32'};" onclick="alert('${(user.status || 'active') === 'active' ? 'Disable' : 'Enable'} user feature coming soon'); return false;">
                                                <i class="fas fa-${(user.status || 'active') === 'active' ? 'ban' : 'check'}"></i> ${(user.status || 'active') === 'active' ? 'Disable' : 'Enable'}
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function filterUsers() {
            const searchTerm = document.getElementById('user-search')?.value.toLowerCase() || '';
            const typeFilter = document.getElementById('user-type-filter')?.value || 'all';
            const statusFilter = document.getElementById('user-status-filter')?.value || 'all';
            const grid = document.getElementById('users-grid');
            if (!grid) return;
            
            const cards = grid.querySelectorAll('.patient-card-enhanced');
            cards.forEach(card => {
                const name = card.getAttribute('data-name') || '';
                const type = card.getAttribute('data-type') || '';
                const status = card.getAttribute('data-status') || '';
                const matchesSearch = name.includes(searchTerm);
                const matchesType = typeFilter === 'all' || type === typeFilter;
                const matchesStatus = statusFilter === 'all' || status === statusFilter;
                
                card.style.display = (matchesSearch && matchesType && matchesStatus) ? 'block' : 'none';
            });
        }


        function loadAdminDoctors(admin, content) {
            const doctorsWithStats = DATABASE.doctors.map(doctor => {
                const assignedPatients = DATABASE.patients.filter(p => p.primaryDoctor === doctor.id);
                return {
                    ...doctor,
                    patientLoad: assignedPatients.length,
                    availability: 'Available',
                    nextAppointment: 'Today 2:00 PM'
                };
            });
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Doctor Management</h1>
                    <p>Manage doctor accounts, assignments, and availability</p>
                </div>

                <div class="search-filter-bar">
                    <input type="text" class="search-input" placeholder="Search doctors by name, specialization, or department..." id="doctor-search">
                    <select class="filter-select" id="doctor-specialization-filter">
                        <option value="all">All Specializations</option>
                        ${[...new Set(DATABASE.doctors.map(d => d.specialization))].map(spec => `
                            <option value="${spec}">${spec}</option>
                        `).join('')}
                    </select>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-user-md"></i>
                            All Doctors (${doctorsWithStats.length})
                        </div>
                        <button class="btn-sm btn-outline" onclick="alert('Add doctor feature coming soon')">
                            <i class="fas fa-plus"></i> Add Doctor
                        </button>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); gap: 1.5rem;">
                            ${doctorsWithStats.map(doctor => `
                                <div class="patient-card-enhanced">
                                    <div class="patient-card-header">
                                        <div>
                                            <div class="patient-card-name">
                                                <i class="fas fa-user-md"></i> Dr. ${doctor.name}
                                            </div>
                                            <div class="patient-card-info">
                                                ${doctor.specialization}  ${doctor.department}
                                            </div>
                                            <div style="font-size: 13px; color: var(--text-gray); margin-top: 8px;">
                                                <i class="fas fa-envelope"></i> ${doctor.email}<br>
                                                <i class="fas fa-phone"></i> ${doctor.phone || 'N/A'}
                                            </div>
                                        </div>
                                        <span class="status-badge ${doctor.status === 'active' ? 'status-stable' : 'status-attention'}">
                                            ${doctor.status}
                                        </span>
                                    </div>
                                    <div style="margin-top: 16px; padding: 12px; background: var(--light-gray); border-radius: 8px;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <span style="font-size: 13px; color: var(--text-gray);">Patient Load:</span>
                                            <strong>${doctor.patientLoad} patients</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <span style="font-size: 13px; color: var(--text-gray);">Availability:</span>
                                            <strong style="color: var(--primary-green);">${doctor.availability}</strong>
                                        </div>
                                        <div style="display: flex; justify-content: space-between;">
                                            <span style="font-size: 13px; color: var(--text-gray);">Next Appointment:</span>
                                            <strong>${doctor.nextAppointment}</strong>
                                        </div>
                                    </div>
                                    <div style="margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap;">
                                        <button class="btn-sm btn-outline" onclick="alert('View doctor details feature coming soon')">
                                            <i class="fas fa-eye"></i> View
                                        </button>
                                        <button class="btn-sm btn-outline" onclick="alert('Edit doctor feature coming soon')">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button class="btn-sm btn-outline" onclick="alert('View schedule feature coming soon')">
                                            <i class="fas fa-calendar"></i> Schedule
                                        </button>
                                        <button class="btn-sm btn-outline" style="background: #FFE5E5; color: #C33;" onclick="alert('Remove doctor feature coming soon')">
                                            <i class="fas fa-trash"></i> Remove
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function loadAdminAppointments(admin, content) {
            const appointments = [
                { date: new Date().toISOString().split('T')[0], time: '9:00 AM', patient: 'John Doe', doctor: 'Dr. Sarah Smith', department: 'Cardiology', status: 'Confirmed', type: 'Follow-up' },
                { date: new Date().toISOString().split('T')[0], time: '10:30 AM', patient: 'Jane Smith', doctor: 'Dr. Michael Johnson', department: 'Pulmonology', status: 'Confirmed', type: 'Consultation' },
                { date: new Date().toISOString().split('T')[0], time: '2:00 PM', patient: 'Mike Johnson', doctor: 'Dr. Sarah Smith', department: 'Cardiology', status: 'Pending', type: 'Review' },
                { date: new Date().toISOString().split('T')[0], time: '3:30 PM', patient: 'Sarah Williams', doctor: 'Dr. Emily Williams', department: 'General', status: 'Confirmed', type: 'Check-up' },
                { date: new Date(Date.now() + 86400000).toISOString().split('T')[0], time: '9:00 AM', patient: 'John Doe', doctor: 'Dr. Sarah Smith', department: 'Cardiology', status: 'Confirmed', type: 'Follow-up' }
            ];
            
            const cancelled = 3;
            const rescheduled = 2;
            const conflicts = 1;
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>Appointment System Management</h1>
                    <p>Manage and monitor all appointments, cancellations, and scheduling conflicts</p>
                </div>

                <div class="dashboard-grid" style="margin-bottom: 24px;">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-calendar-check"></i>
                                Upcoming Appointments
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 32px; font-weight: 700; color: var(--primary-blue);">${appointments.filter(a => a.status === 'Confirmed').length}</div>
                            <p style="color: var(--text-gray);">Confirmed appointments</p>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-times-circle"></i>
                                Cancelled / Rescheduled
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 32px; font-weight: 700; color: #FF4444;">${cancelled + rescheduled}</div>
                            <p style="color: var(--text-gray);">Cancelled: ${cancelled}  Rescheduled: ${rescheduled}</p>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-exclamation-triangle"></i>
                                Scheduling Conflicts
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="font-size: 32px; font-weight: 700; color: #FFC107;">${conflicts}</div>
                            <p style="color: var(--text-gray);">Requires attention</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-calendar-alt"></i>
                            All Appointments
                        </div>
                        <button class="btn-sm btn-outline" onclick="alert('Create appointment feature coming soon')">
                            <i class="fas fa-plus"></i> Create Appointment
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="appointment-list">
                            ${appointments.map(apt => `
                                <div class="appointment-card-item">
                                    <div class="appointment-date">
                                        <i class="fas fa-calendar"></i> ${new Date(apt.date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })} at ${apt.time}
                                    </div>
                                    <div class="appointment-details">
                                        <div><strong>Patient:</strong> ${apt.patient}</div>
                                        <div><strong>Doctor:</strong> ${apt.doctor}</div>
                                        <div><strong>Department:</strong> ${apt.department}</div>
                                        <div><strong>Type:</strong> ${apt.type}</div>
                                        <div><strong>Status:</strong> <span class="badge ${apt.status === 'Confirmed' ? 'badge-normal' : 'badge-abnormal'}">${apt.status}</span></div>
                                    </div>
                                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                        <button class="btn-sm btn-outline" onclick="alert('Edit appointment feature coming soon')">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button class="btn-sm btn-outline" onclick="alert('Approve/override feature coming soon')">
                                            <i class="fas fa-check"></i> Approve
                                        </button>
                                        <button class="btn-sm btn-outline" style="background: #FFE5E5; color: #C33;" onclick="alert('Cancel appointment feature coming soon')">
                                            <i class="fas fa-times"></i> Cancel
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function loadAdminAnalytics(admin, content) {
            const stats = {
                totalPatients: DATABASE.patients.length,
                activePatients: DATABASE.patients.filter(p => p.status === 'active').length,
                totalDoctors: DATABASE.doctors.length,
                totalAppointments: 156,
                avgAppointmentsPerDay: 4.8,
                patientSatisfaction: 4.6,
                dailyLogins: [156, 142, 168, 175, 161, 149, 158],
                appointmentVolume: [24, 28, 22, 26, 30, 25, 27],
                noShowRate: 8.5,
                mostRequestedDept: 'Cardiology',
                departmentStats: [
                    { name: 'Cardiology', appointments: 45, doctors: 3 },
                    { name: 'Pulmonology', appointments: 32, doctors: 2 },
                    { name: 'General', appointments: 28, doctors: 2 },
                    { name: 'Neurology', appointments: 18, doctors: 1 }
                ]
            };

            content.innerHTML = `
                <div class="page-header">
                    <h1>Analytics Overview</h1>
                    <p>System performance metrics and statistics</p>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-sign-in-alt"></i>
                                Daily Logins (Last 7 Days)
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <div style="text-align: center; padding: 20px;">
                                    <div style="display: flex; align-items: flex-end; justify-content: space-around; height: 200px; margin-bottom: 20px;">
                                        ${stats.dailyLogins.map((val, i) => `
                                            <div style="display: flex; flex-direction: column; align-items: center;">
                                                <div style="width: 30px; background: var(--primary-blue); height: ${(val / 200) * 180}px; border-radius: 4px 4px 0 0; margin-bottom: 8px;"></div>
                                                <span style="font-size: 11px; color: var(--text-gray);">${['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'][i]}</span>
                                                <span style="font-size: 10px; color: var(--text-gray);">${val}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <p style="color: var(--text-gray); font-size: 14px;">Average: ${Math.round(stats.dailyLogins.reduce((a,b) => a+b, 0) / stats.dailyLogins.length)} logins/day</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-calendar-check"></i>
                                Appointment Volume (Last 7 Days)
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <div style="text-align: center; padding: 20px;">
                                    <div style="display: flex; align-items: flex-end; justify-content: space-around; height: 200px; margin-bottom: 20px;">
                                        ${stats.appointmentVolume.map((val, i) => `
                                            <div style="display: flex; flex-direction: column; align-items: center;">
                                                <div style="width: 30px; background: var(--primary-green); height: ${(val / 35) * 180}px; border-radius: 4px 4px 0 0; margin-bottom: 8px;"></div>
                                                <span style="font-size: 11px; color: var(--text-gray);">${['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'][i]}</span>
                                                <span style="font-size: 10px; color: var(--text-gray);">${val}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <p style="color: var(--text-gray); font-size: 14px;">Total: ${stats.appointmentVolume.reduce((a,b) => a+b, 0)} appointments</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-user-times"></i>
                                No-Show Rate
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="text-align: center;">
                                <div style="font-size: 48px; font-weight: 700; color: ${stats.noShowRate > 10 ? '#FF4444' : '#4CAF50'}; margin-bottom: 8px;">
                                    ${stats.noShowRate}%
                                </div>
                                <p style="color: var(--text-gray);">Last 30 days</p>
                                <div style="margin-top: 16px; padding: 12px; background: var(--light-gray); border-radius: 8px;">
                                    <div style="font-size: 13px; color: var(--text-gray);">
                                        Target: &lt;10%<br>
                                        Status: ${stats.noShowRate < 10 ? '<span style="color: #4CAF50;"> Good</span>' : '<span style="color: #FF4444;"> Needs Attention</span>'}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-building"></i>
                                Most Requested Departments
                            </div>
                        </div>
                        <div class="card-body">
                            ${stats.departmentStats.map(dept => `
                                <div style="margin-bottom: 16px; padding: 12px; background: var(--light-gray); border-radius: 8px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                        <strong>${dept.name}</strong>
                                        <span style="color: var(--primary-blue); font-weight: 600;">${dept.appointments} appointments</span>
                                    </div>
                                    <div style="font-size: 13px; color: var(--text-gray);">
                                        <i class="fas fa-user-md"></i> ${dept.doctors} doctor${dept.doctors > 1 ? 's' : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-chart-line"></i>
                                System Usage Metrics
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Total Patients</span>
                                    <strong>${stats.totalPatients}</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Active Patients</span>
                                    <strong style="color: var(--primary-green);">${stats.activePatients}</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>Total Doctors</span>
                                    <strong>${stats.totalDoctors}</strong>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Avg Appointments/Day</span>
                                    <strong>${stats.avgAppointmentsPerDay}</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-star"></i>
                                Patient Satisfaction
                            </div>
                        </div>
                        <div class="card-body">
                            <div style="text-align: center;">
                                <div style="font-size: 48px; font-weight: 700; color: var(--primary-green); margin-bottom: 8px;">
                                    ${stats.patientSatisfaction}/5.0
                                </div>
                                <p style="color: var(--text-gray);">Based on 142 reviews</p>
                                <div style="margin-top: 16px; font-size: 24px; color: #FFC107;">
                                    ${''.repeat(Math.round(stats.patientSatisfaction))}${''.repeat(5 - Math.round(stats.patientSatisfaction))}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function loadAdminLogs(admin, content) {
            const logs = [
                { date: new Date().toISOString().replace('T', ' ').substring(0, 16), action: 'User Login', user: 'john.doe', type: 'info', category: 'Security' },
                { date: new Date(Date.now() - 3600000).toISOString().replace('T', ' ').substring(0, 16), action: 'Appointment Created', user: 'System', type: 'success', category: 'Appointment' },
                { date: new Date(Date.now() - 7200000).toISOString().replace('T', ' ').substring(0, 16), action: 'Failed Login Attempt', user: 'unknown.user', type: 'warning', category: 'Security' },
                { date: new Date(Date.now() - 10800000).toISOString().replace('T', ' ').substring(0, 16), action: 'Report Generated', user: 'dr.smith', type: 'info', category: 'Medical' },
                { date: new Date(Date.now() - 14400000).toISOString().replace('T', ' ').substring(0, 16), action: 'User Disabled', user: 'admin.smith', type: 'warning', category: 'User Management' },
                { date: new Date(Date.now() - 18000000).toISOString().replace('T', ' ').substring(0, 16), action: 'Prescription Updated', user: 'dr.smith', type: 'success', category: 'Medical' },
                { date: new Date(Date.now() - 21600000).toISOString().replace('T', ' ').substring(0, 16), action: 'System Backup', user: 'System', type: 'info', category: 'System' },
                { date: new Date(Date.now() - 25200000).toISOString().replace('T', ' ').substring(0, 16), action: 'Doctor Added', user: 'admin.smith', type: 'success', category: 'User Management' }
            ];
            
            content.innerHTML = `
                <div class="page-header">
                    <h1>System Logs</h1>
                    <p>Monitor system activity, security logs, and audit trail</p>
                </div>

                <div class="search-filter-bar">
                    <input type="text" class="search-input" placeholder="Search logs..." id="log-search">
                    <select class="filter-select" id="log-category-filter">
                        <option value="all">All Categories</option>
                        <option value="Security">Security</option>
                        <option value="Appointment">Appointment</option>
                        <option value="Medical">Medical</option>
                        <option value="User Management">User Management</option>
                        <option value="System">System</option>
                    </select>
                    <select class="filter-select" id="log-type-filter">
                        <option value="all">All Types</option>
                        <option value="info">Info</option>
                        <option value="success">Success</option>
                        <option value="warning">Warning</option>
                        <option value="error">Error</option>
                    </select>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-file-alt"></i>
                            System Activity Logs
                        </div>
                        <button class="btn-sm btn-outline" onclick="alert('Export logs feature coming soon')">
                            <i class="fas fa-download"></i> Export Logs
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="records-timeline">
                            ${logs.map(log => {
                                const dotColor = log.type === 'success' ? 'var(--primary-green)' : 
                                                log.type === 'warning' ? '#FFC107' : 
                                                log.type === 'error' ? '#FF4444' : 'var(--primary-blue)';
                                return `
                                    <div class="timeline-item" data-category="${log.category}" data-type="${log.type}">
                                        <div class="timeline-dot" style="background: ${dotColor};"></div>
                                        <div class="timeline-content">
                                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 4px;">
                                                <div class="timeline-date">${log.date}</div>
                                                <span style="padding: 4px 8px; background: var(--light-gray); border-radius: 4px; font-size: 11px; color: var(--text-gray);">${log.category}</span>
                                            </div>
                                            <div class="timeline-title">${log.action}</div>
                                            <p style="font-size: 14px; color: var(--text-gray);">User: ${log.user}  Type: ${log.type}</p>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;
        }


        function showDashboardSection(section) {
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            if (event && event.target.closest('.menu-item')) {
                event.target.closest('.menu-item').classList.add('active');
            }
            
            const content = document.getElementById('patient-dashboard-content');
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            const patient = DATABASE.patients.find(p => p.id === user.id);
            
            switch(section) {
                case 'patient-overview':
                    loadDashboardOverview(patient, content);
                    break;
                case 'patient-records':
                    loadMedicalRecords(patient, content);
                    break;
                case 'patient-medications':
                    loadMedications(patient, content);
                    break;
                case 'patient-appointments':
                    loadAppointments(patient, content);
                    break;
            }
        }

        function loadDashboardOverview(patient, content) {
            if (!patient) return;
            
            const doctor = DATABASE.doctors.find(d => d.id === patient.primaryDoctor);
            const nextAppointment = {
                date: '2024-02-15',
                time: '10:00 AM',
                doctor: doctor ? doctor.name : 'Dr. Smith',
                specialty: doctor ? doctor.specialization : 'Cardiology',
                location: 'Main Campus - Building A, Room 205'
            };

            content.innerHTML = `
                <div class="page-header">
                    <h1>Dashboard</h1>
                    <p>Your health information at a glance</p>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <a href="#" class="action-btn" onclick="showDashboardSection('patient-appointments'); return false;">
                        <i class="fas fa-calendar-plus"></i>
                        <span>Schedule Appointment</span>
                    </a>
                    <a href="#" class="action-btn" onclick="alert('Message feature coming soon'); return false;">
                        <i class="fas fa-envelope"></i>
                        <span>Message Hospital</span>
                    </a>
                    <a href="#" class="action-btn" onclick="showDashboardSection('patient-medications'); return false;">
                        <i class="fas fa-prescription-bottle-alt"></i>
                        <span>Request Refill</span>
                    </a>
                    <a href="#" class="action-btn" onclick="showDashboardSection('patient-records'); return false;">
                        <i class="fas fa-file-medical-alt"></i>
                        <span>View Lab Results</span>
                    </a>
                    <a href="#" class="action-btn" onclick="alert('Profile update coming soon'); return false;">
                        <i class="fas fa-user-edit"></i>
                        <span>Update Profile</span>
                    </a>
                </div>

                <div class="dashboard-grid">
                    <!-- Next Appointment Card -->
                    <div class="dashboard-card appointment-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-calendar-check"></i>
                                Next Appointment
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="appointment-info">
                                <div class="appointment-info-item">
                                    <i class="fas fa-user-md"></i>
                                    <span><strong>${nextAppointment.doctor}</strong> - ${nextAppointment.specialty}</span>
                                </div>
                                <div class="appointment-info-item">
                                    <i class="fas fa-calendar"></i>
                                    <span>${new Date(nextAppointment.date).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</span>
                                </div>
                                <div class="appointment-info-item">
                                    <i class="fas fa-clock"></i>
                                    <span>${nextAppointment.time}</span>
                                </div>
                                <div class="appointment-info-item">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>${nextAppointment.location}</span>
                                </div>
                            </div>
                            <div class="appointment-actions">
                                <button class="btn-sm btn-outline" onclick="alert('Reschedule feature coming soon')">Reschedule</button>
                                <button class="btn-sm btn-outline" onclick="alert('Cancel appointment feature coming soon')">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <!-- Current Medications Card -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-pills"></i>
                                Current Medications
                            </div>
                        </div>
                        <div class="card-body">
                            ${patient.currentMedications && patient.currentMedications.length > 0 ? 
                                patient.currentMedications.slice(0, 3).map(med => `
                                    <div class="medication-item">
                                        <div class="medication-info">
                                            <h4>${med}</h4>
                                            <p>As prescribed by your doctor</p>
                                        </div>
                                    </div>
                                `).join('') + 
                                (patient.currentMedications.length > 3 ? `<p style="text-align: center; margin-top: 12px;"><a href="#" onclick="showDashboardSection('patient-medications'); return false;">View all ${patient.currentMedications.length} medications</a></p>` : '') :
                                '<p>No current medications</p>'
                            }
                            <button class="btn-sm btn-outline" style="width: 100%; margin-top: 16px;" onclick="showDashboardSection('patient-medications')">View All Medications</button>
                        </div>
                    </div>

                    <!-- Ongoing Health Queries Card -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-question-circle"></i>
                                Ongoing Health Queries
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="query-item">
                                <div class="query-header">
                                    <div class="query-title">Blood sugar monitoring</div>
                                    <span class="query-priority priority-medium">In Review</span>
                                </div>
                                <p style="font-size: 14px; color: var(--text-gray); margin: 8px 0 0 0;">Reviewed by ${doctor ? doctor.name : 'Dr. Smith'}</p>
                            </div>
                            <div class="query-item">
                                <div class="query-header">
                                    <div class="query-title">Hypertension follow-up</div>
                                    <span class="query-priority priority-low">Active</span>
                                </div>
                                <p style="font-size: 14px; color: var(--text-gray); margin: 8px 0 0 0;">Reviewed by ${doctor ? doctor.name : 'Dr. Smith'}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Care Team Card -->
                    <div class="dashboard-card" style="grid-column: 1 / -1;">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-users"></i>
                                Your Care Team
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="care-team-grid">
                                ${doctor ? `
                                    <div class="doctor-card">
                                        <div class="doctor-avatar">${doctor.name.split(' ').map(n => n[0]).join('')}</div>
                                        <div class="doctor-name">${doctor.name}</div>
                                        <div class="doctor-specialty">${doctor.specialization}</div>
                                        <div class="doctor-actions">
                                            <button class="btn-sm btn-outline" onclick="alert('Message feature coming soon')">Message</button>
                                            <button class="btn-sm btn-outline" onclick="alert('Case notes feature coming soon')">View Notes</button>
                                        </div>
                                    </div>
                                ` : ''}
                                ${DATABASE.doctors.slice(0, 2).map(doc => `
                                    <div class="doctor-card">
                                        <div class="doctor-avatar">${doc.name.split(' ').map(n => n[0]).join('')}</div>
                                        <div class="doctor-name">${doc.name}</div>
                                        <div class="doctor-specialty">${doc.specialization}</div>
                                        <div class="doctor-actions">
                                            <button class="btn-sm btn-outline" onclick="alert('Message feature coming soon')">Message</button>
                                            <button class="btn-sm btn-outline" onclick="alert('Case notes feature coming soon')">View Notes</button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function loadAppointments(patient, content) {
            if (!patient) return;
            
            const doctor = DATABASE.doctors.find(d => d.id === patient.primaryDoctor);
            const upcomingAppointments = [
                {
                    id: 1,
                    date: '2024-02-15',
                    time: '10:00 AM',
                    doctor: doctor ? doctor.name : 'Dr. Sarah Smith',
                    specialty: doctor ? doctor.specialization : 'Cardiology',
                    location: 'Main Campus - Building A, Room 205',
                    type: 'Follow-up'
                },
                {
                    id: 2,
                    date: '2024-02-28',
                    time: '2:30 PM',
                    doctor: 'Dr. Michael Johnson',
                    specialty: 'Radiology',
                    location: 'Main Campus - Building B, Room 120',
                    type: 'Lab Review'
                }
            ];

            const appointmentHistory = [
                {
                    date: '2024-01-10',
                    doctor: doctor ? doctor.name : 'Dr. Sarah Smith',
                    summary: 'Routine check-up and blood work review',
                    diagnosis: 'Type 2 Diabetes - Well controlled',
                    prescription: 'Continue Metformin 500mg twice daily'
                },
                {
                    date: '2023-12-05',
                    doctor: doctor ? doctor.name : 'Dr. Sarah Smith',
                    summary: 'Blood pressure monitoring',
                    diagnosis: 'Hypertension - Stable',
                    prescription: 'Continue Lisinopril 10mg daily'
                }
            ];

            content.innerHTML = `
                <div class="page-header">
                    <h1>Appointments</h1>
                    <p>Manage your upcoming appointments and view history</p>
                </div>

                <div class="dashboard-card" style="margin-bottom: 32px;">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-calendar-plus"></i>
                            Schedule New Appointment
                        </div>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary" onclick="openScheduleModal()">
                            <i class="fas fa-plus"></i> Schedule Appointment
                        </button>
                    </div>
                </div>

                <div class="dashboard-card" style="margin-bottom: 32px;">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-calendar-check"></i>
                            Upcoming Appointments
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="appointment-list">
                            ${upcomingAppointments.map(apt => `
                                <div class="appointment-card-item">
                                    <div class="appointment-date">
                                        <i class="fas fa-calendar"></i> ${new Date(apt.date).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })} at ${apt.time}
                                    </div>
                                    <div class="appointment-details">
                                        <div>
                                            <strong><i class="fas fa-user-md"></i> Doctor:</strong><br>
                                            ${apt.doctor}<br>
                                            <span style="color: var(--text-gray); font-size: 14px;">${apt.specialty}</span>
                                        </div>
                                        <div>
                                            <strong><i class="fas fa-map-marker-alt"></i> Location:</strong><br>
                                            ${apt.location}
                                        </div>
                                        <div>
                                            <strong><i class="fas fa-info-circle"></i> Type:</strong><br>
                                            ${apt.type}
                                        </div>
                                    </div>
                                    <div class="appointment-actions">
                                        <button class="btn-sm btn-outline" onclick="alert('Reschedule feature coming soon')">Reschedule</button>
                                        <button class="btn-sm btn-outline" onclick="alert('Cancel appointment feature coming soon')">Cancel</button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-history"></i>
                            Appointment History
                        </div>
                    </div>
                    <div class="card-body">
                        ${appointmentHistory.map(apt => `
                            <div class="appointment-history-item">
                                <div class="appointment-date">
                                    <i class="fas fa-calendar"></i> ${new Date(apt.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
                                </div>
                                <div><strong>Doctor:</strong> ${apt.doctor}</div>
                                <div class="appointment-summary">
                                    <h4>Visit Summary:</h4>
                                    <p>${apt.summary}</p>
                                    <h4>Diagnosis:</h4>
                                    <p>${apt.diagnosis}</p>
                                    <h4>Prescription:</h4>
                                    <p>${apt.prescription}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function loadMedicalRecords(patient, content) {
            if (!patient) return;

            content.innerHTML = `
                <div class="page-header">
                    <h1>Medical Records</h1>
                    <p>Your complete medical history and test results</p>
                </div>

                <div class="dashboard-card" style="margin-bottom: 32px;">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-vial"></i>
                            Lab Results
                        </div>
                    </div>
                    <div class="card-body">
                        ${Object.entries(patient.testResults || {}).filter(([k]) => k !== 'lastUpdated').map(([key, value]) => {
                            const isAbnormal = (key.includes('Sugar') && parseFloat(value) > 126) || 
                                             (key.includes('Pressure') && value.includes('150')) ||
                                             (key.includes('cholesterol') && parseFloat(value) > 200);
                            return `
                                <div class="lab-result-item">
                                    <div>
                                        <div class="lab-result-name">${key.replace(/([A-Z])/g, ' $1').trim()}</div>
                                        <div class="lab-result-value">${value}</div>
                                    </div>
                                    <span class="badge ${isAbnormal ? 'badge-abnormal' : 'badge-normal'}">
                                        ${isAbnormal ? 'Abnormal' : 'Normal'}
                                    </span>
                                </div>
                            `;
                        }).join('')}
                        <button class="download-btn" style="margin-top: 16px;" onclick="alert('Download feature coming soon')">
                            <i class="fas fa-download"></i> Download Full Report
                        </button>
                    </div>
                </div>

                <div class="dashboard-card" style="margin-bottom: 32px;">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-diagnoses"></i>
                            Past Diagnoses
                        </div>
                    </div>
                    <div class="card-body">
                        ${patient.medicalHistory && patient.medicalHistory.length > 0 ? 
                            patient.medicalHistory.map(diag => `
                                <div style="padding: 12px; background: var(--light-gray); border-radius: 8px; margin-bottom: 8px;">
                                    <strong>${diag}</strong>
                                </div>
                            `).join('') : 
                            '<p>No past diagnoses recorded</p>'
                        }
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-syringe"></i>
                            Immunizations
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="records-timeline">
                            <div class="timeline-item">
                                <div class="timeline-dot"></div>
                                <div class="timeline-content">
                                    <div class="timeline-date">2023-10-15</div>
                                    <div class="timeline-title">Flu Vaccine</div>
                                    <p>Annual flu vaccination administered</p>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-dot"></div>
                                <div class="timeline-content">
                                    <div class="timeline-date">2023-05-20</div>
                                    <div class="timeline-title">COVID-19 Booster</div>
                                    <p>COVID-19 booster shot administered</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function loadMedications(patient, content) {
            if (!patient) return;

            const medications = patient.currentMedications || [];
            const medicationDetails = {
                'Metformin': { dosage: '500mg', frequency: 'Twice daily', nextRefill: '2024-02-20', status: 'active' },
                'Lisinopril': { dosage: '10mg', frequency: 'Once daily', nextRefill: '2024-02-18', status: 'active' }
            };

            content.innerHTML = `
                <div class="page-header">
                    <h1>Medications</h1>
                    <p>Manage your current and past medications</p>
                </div>

                <div class="medication-section">
                    <h3 class="section-title">Current Medications</h3>
                    ${medications.length > 0 ? medications.map(med => {
                        const details = medicationDetails[med] || { dosage: 'As prescribed', frequency: 'As directed', nextRefill: 'N/A', status: 'active' };
                        const refillDate = new Date(details.nextRefill);
                        const today = new Date();
                        const daysUntil = Math.ceil((refillDate - today) / (1000 * 60 * 60 * 24));
                        let refillClass = 'refill-active';
                        let refillText = `Next refill: ${refillDate.toLocaleDateString()}`;
                        
                        if (daysUntil <= 0) {
                            refillClass = 'refill-expired';
                            refillText = 'Refill overdue';
                        } else if (daysUntil <= 7) {
                            refillClass = 'refill-due';
                            refillText = `Refill due in ${daysUntil} days`;
                        }

                        return `
                            <div class="medication-item">
                                <div class="medication-info">
                                    <h4>${med}</h4>
                                    <div class="medication-details">
                                        <div class="medication-detail-item"><strong>Dosage:</strong> ${details.dosage}</div>
                                        <div class="medication-detail-item"><strong>Frequency:</strong> ${details.frequency}</div>
                                        <div class="medication-detail-item"><strong>Next Refill:</strong> ${refillDate.toLocaleDateString()}</div>
                                        <span class="refill-status ${refillClass}">${refillText}</span>
                                    </div>
                                </div>
                                <button class="btn-sm btn-outline" onclick="alert('Refill request submitted for ${med}')">Request Refill</button>
                            </div>
                        `;
                    }).join('') : '<p>No current medications</p>'}
                </div>

                <div class="medication-section">
                    <h3 class="section-title">Medication Reminders</h3>
                    <div class="dashboard-card">
                        <div class="card-body">
                            <p><i class="fas fa-bell"></i> You have medication reminders set for all active medications</p>
                            <button class="btn-sm btn-outline" style="margin-top: 12px;" onclick="alert('Reminder settings coming soon')">Manage Reminders</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function openScheduleModal() {
            alert('Schedule appointment modal - Full implementation coming soon. This would include date picker, time slots, and doctor selection.');
        }

        // ============================================
        // CHATBOT FUNCTIONALITY
        // ============================================
        let chatbotMinimized = false;

        function minimizeChatbot() {
            chatbotMinimized = true;
            const container = document.getElementById('chatbot-container');
            const floatingIcon = document.getElementById('chatbot-floating-icon');
            
            // Hide chatbot window
            if (container) {
                container.style.display = 'none';
                container.classList.add('minimized');
            }
            
            // Show floating icon
            if (floatingIcon) {
                floatingIcon.style.display = 'flex';
                floatingIcon.classList.add('show');
            }
        }

        function openChatbot() {
            chatbotMinimized = false;
            const container = document.getElementById('chatbot-container');
            const floatingIcon = document.getElementById('chatbot-floating-icon');
            
            // Hide floating icon
            if (floatingIcon) {
                floatingIcon.style.display = 'none';
                floatingIcon.classList.remove('show');
            }
            
            // Show chatbot window
            if (container) {
                container.style.display = 'flex';
                container.classList.remove('minimized');
            }
        }

        function handleChatbotKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatbotMessage();
            }
        }

        function sendChatbotMessage() {
            const input = document.getElementById('chatbot-input');
            const message = input.value.trim();
            if (!message) return;

            const messagesContainer = document.getElementById('chatbot-messages');
            const userMessage = document.createElement('div');
            userMessage.className = 'message user';
            userMessage.innerHTML = `
                <div class="message-avatar"></div>
                <div class="message-content">${message}</div>
            `;
            messagesContainer.appendChild(userMessage);
            input.value = '';
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            const sendBtn = document.querySelector('.chatbot-send');
            sendBtn.disabled = true;

            setTimeout(() => {
                const botMessage = document.createElement('div');
                botMessage.className = 'message bot';
                botMessage.innerHTML = `
                    <div class="message-avatar"></div>
                    <div class="message-content">${getChatbotResponse(message)}</div>
                `;
                messagesContainer.appendChild(botMessage);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                sendBtn.disabled = false;
            }, 500);
        }

        // ============================================
        // INTENT DETECTION ENGINE
        // ============================================
        function getIntent(message) {
            const lowerMessage = message.toLowerCase().trim();
            
            // Appointment Requests
            const appointmentKeywords = [
                'book appointment', 'schedule appointment', 'reschedule', 'cancel appointment',
                'doctor visit', 'appointment', 'book', 'schedule', 'reschedule', 'cancel',
                'make appointment', 'set appointment', 'appointment booking', 'visit doctor'
            ];
            if (appointmentKeywords.some(keyword => lowerMessage.includes(keyword))) {
                return 'appointment';
            }
            
            // Test / Lab Requests
            const testKeywords = [
                'test', 'blood test', 'lab test', 'scan', 'report', 'x-ray', 'mri', 'ct scan',
                'ultrasound', 'lab results', 'test results', 'laboratory', 'diagnostic test',
                'medical test', 'screening', 'checkup', 'examination'
            ];
            if (testKeywords.some(keyword => lowerMessage.includes(keyword))) {
                return 'test';
            }
            
            // Refill Requests
            const refillKeywords = [
                'refill', 'medication refill', 'need more medicine', 'prescription refill',
                'refill prescription', 'need refill', 'medicine refill', 'get more pills',
                'renew prescription', 'prescription renewal'
            ];
            if (refillKeywords.some(keyword => lowerMessage.includes(keyword))) {
                return 'refill';
            }
            
            // Hospital / Admin Questions
            const adminKeywords = [
                'visiting hours', 'hospital address', 'insurance', 'contact', 'phone number',
                'location', 'address', 'hours', 'timings', 'admin', 'administration',
                'billing', 'payment', 'general info', 'hospital info', 'facility',
                'parking', 'directions', 'how to reach'
            ];
            if (adminKeywords.some(keyword => lowerMessage.includes(keyword))) {
                return 'admin';
            }
            
            // Non-Medical Questions (common non-healthcare topics)
            const nonMedicalKeywords = [
                'president', 'joke', 'chatgpt', 'cook', 'recipe', 'biryani', 'stock market',
                'weather', 'sports', 'movie', 'music', 'game', 'politics', 'news',
                'technology', 'computer', 'programming', 'code', 'python', 'javascript',
                'what is', 'who is', 'tell me about', 'explain', 'how to make',
                'entertainment', 'fun', 'random', 'trivia'
            ];
            // Check if message contains non-medical keywords AND lacks medical context
            const hasNonMedical = nonMedicalKeywords.some(keyword => lowerMessage.includes(keyword));
            const medicalContext = [
                'symptom', 'pain', 'fever', 'medicine', 'doctor', 'health', 'medical',
                'treatment', 'diagnosis', 'disease', 'illness', 'patient', 'hospital'
            ];
            const hasMedicalContext = medicalContext.some(keyword => lowerMessage.includes(keyword));
            
            if (hasNonMedical && !hasMedicalContext) {
                return 'non-medical';
            }
            
            // Medical Questions (symptoms, medications, lab results, health concerns)
            const medicalKeywords = [
                'symptom', 'symptoms', 'pain', 'ache', 'fever', 'headache', 'cough', 'cold',
                'medicine', 'medication', 'drug', 'prescription', 'dosage', 'side effect',
                'lab result', 'test result', 'diagnosis', 'condition', 'disease', 'illness',
                'health concern', 'health question', 'medical question', 'treatment',
                'therapy', 'remedy', 'cure', 'heal', 'recover', 'sick', 'unwell',
                'diabetes', 'heart', 'lung', 'stomach', 'skin', 'mental health',
                'blood pressure', 'cholesterol', 'allergy', 'infection', 'injury'
            ];
            if (medicalKeywords.some(keyword => lowerMessage.includes(keyword))) {
                return 'medical';
            }
            
            // Unknown / Fallback
            return 'unknown';
        }

        // ============================================
        // CHATBOT RESPONSE LOGIC
        // ============================================
        function getChatbotResponse(message) {
            const intent = getIntent(message);
            const lowerMessage = message.toLowerCase();
            
            // Safety disclaimer that will be appended to medical responses
            const safetyDisclaimer = "\n\n **Important**: This is general health information, not a medical diagnosis. Always consult with a qualified healthcare provider for proper diagnosis and treatment. If you're experiencing a medical emergency, call emergency services immediately.";
            
            switch (intent) {
                case 'appointment':
                    return "I can help you with appointments! Please go to the **Appointments** section in your dashboard to schedule, reschedule, or cancel your appointment. You can also view your upcoming appointments and appointment history there.";
                
                case 'test':
                    return "I can assist with test and lab-related questions. Please visit the **Medical Records** section to view your test results and lab reports, or go to the **Appointments** section to request new tests. If you have questions about a specific test, I recommend discussing it with your healthcare provider.";
                
                case 'refill':
                    return "You can request a medication refill from the **Medications** section in your dashboard. There you'll find your current medications, refill status, and a button to request refills. Would you like me to help you navigate there?";
                
                case 'admin':
                    return "I am a medical assistant chatbot. I can help you with medications, appointments, test reports, and symptoms.\n\nFor general hospital queries such as visiting hours, address, insurance, or administrative concerns, please contact the hospital administration directly.";
                
                case 'non-medical':
                    return "I am a medical assistant chatbot and can only help with healthcare-related topics such as:\n Symptoms and health concerns\n Medications and prescriptions\n Appointments and scheduling\n Test results and lab reports\n Patient portal support\n\nPlease ask a medical or portal-related question.";
                
                case 'medical':
                    // Handle specific medical questions with detailed responses
                    if (lowerMessage.includes('fever') || lowerMessage.includes('temperature')) {
                        return "Fever is usually a sign that your body is fighting an infection. If your temperature is above 101F (38.3C) or persists for more than 3 days, please consult a healthcare provider. Stay hydrated and rest." + safetyDisclaimer;
                    }
                    
                    if (lowerMessage.includes('headache')) {
                        return "Headaches can have various causes including stress, dehydration, or underlying conditions. If you experience severe or persistent headaches, especially with other symptoms, please consult a healthcare provider." + safetyDisclaimer;
                    }
                    
                    if (lowerMessage.includes('cough') || lowerMessage.includes('cold')) {
                        return "For coughs and colds, rest, stay hydrated, and consider over-the-counter remedies. If symptoms persist for more than 10 days or worsen, consult a healthcare provider." + safetyDisclaimer;
                    }
                    
                    if (lowerMessage.includes('diabetes') || lowerMessage.includes('blood sugar')) {
                        return "Diabetes management involves monitoring blood sugar levels, maintaining a healthy diet, regular exercise, and medication as prescribed. Regular check-ups with your healthcare provider are essential." + safetyDisclaimer;
                    }
                    
                    if (lowerMessage.includes('heart') || lowerMessage.includes('cardiac')) {
                        return "Heart health is crucial. Maintain a healthy diet, exercise regularly, avoid smoking, and manage stress. If you experience chest pain, shortness of breath, or other cardiac symptoms, seek immediate medical attention." + safetyDisclaimer;
                    }
                    
                    if (lowerMessage.includes('medication') || lowerMessage.includes('medicine') || lowerMessage.includes('prescription')) {
                        return "For medication-related questions, I recommend discussing with your healthcare provider or pharmacist. You can view your current medications in the **Medications** section. Always follow your doctor's prescribed dosage and instructions." + safetyDisclaimer;
                    }
                    
                    if (lowerMessage.includes('lab result') || lowerMessage.includes('test result') || lowerMessage.includes('report')) {
                        return "You can view your lab results and test reports in the **Medical Records** section. If you have questions about specific results, I strongly recommend discussing them with your healthcare provider for proper interpretation." + safetyDisclaimer;
                    }
                    
                    // General medical response
                    return "Thank you for your health-related question. While I can provide general information, I'm not a medical professional and cannot provide diagnoses. For specific medical advice, diagnosis, or treatment, please consult with a qualified healthcare provider." + safetyDisclaimer;
                
                case 'unknown':
                default:
                    return "I'm not sure I understand your question. I can assist you with:\n **Symptoms and health concerns**\n **Medications and prescriptions**\n **Appointments and scheduling**\n **Test results and lab reports**\n **Patient portal navigation**\n\nPlease rephrase your question or ask about one of these topics.";
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        window.addEventListener('DOMContentLoaded', () => {
            // Hide chatbot initially (only show in patient dashboard)
            const chatbot = document.getElementById('chatbot-container');
            const floatingIcon = document.getElementById('chatbot-floating-icon');
            if (chatbot) {
                chatbot.style.display = 'flex';
            }
            if (floatingIcon) {
                floatingIcon.style.display = 'none';
            }

            const user = localStorage.getItem('user');
            if (user) {
                const userData = JSON.parse(user);
                if (userData.role === 'patient') {
                    const patient = DATABASE.patients.find(p => p.id === userData.id);
                    if (patient) {
                        loadPatientDashboard(patient);
                        showPage('patient-dashboard');
                    }
                } else if (userData.role === 'doctor') {
                    const doctor = DATABASE.doctors.find(d => d.id === userData.id);
                    if (doctor) {
                        loadDoctorDashboard(doctor);
                        showPage('doctor-dashboard');
                    }
                } else if (userData.role === 'admin') {
                    const admin = DATABASE.administrators.find(a => a.id === userData.id);
                    if (admin) {
                        loadAdminDashboard(admin);
                        showPage('admin-dashboard');
                    }
                }
            }
        });
    </script>
</body>
</html>
